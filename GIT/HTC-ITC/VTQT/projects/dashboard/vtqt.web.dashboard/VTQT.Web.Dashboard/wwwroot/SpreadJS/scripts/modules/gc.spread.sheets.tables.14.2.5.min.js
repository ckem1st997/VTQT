/*!
 * 
 * SpreadJS Library 14.2.5
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Tables=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/table/table.entry.js")}({"./dist/plugins/table/table-action.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/table/table-util.js"),g=f.Util.$Lb,h=f.Util.PIb,i=f.Util.QIb,j=f.Util._getTable,k=f.Util._Mb,l=d.Commands.ActionBase,m=e.Common.j.Fa,n="tableResize",o="tableInsertRows",p="tableDeleteRows",q="tableInsertColumns",r="tableDeleteColumns",s="tableToRange",t="tableTotalRowFormula",u="DoInsertRows",v="tableShowFooter",w="tableInsertRowsAboveForContextMenu",x="tableInsertRowsBelowForContextMenu",y="tableDeleteRowsForContextMenu",z="tableInsertColumnsLeftForContextMenu",A="tableInsertColumnsRightForContextMenu",B="tableDeleteColumnsForContextMenu",C=void 0,D=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d._Lb=c,d.aMb=c.tableName,d.bMb=c.resizeToRange,d}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,c=k.aMb,e=k._Lb,b.startTransaction(),k.Lz(a,!0);try{f=a.tables.findByName(c),f&&(h=f.range(),i=k.bMb,a.tables.resize(f,i),g(a,f,h,i),l=!0)}finally{k.Mz(a),j=d.Commands.bWa(a.name()),e[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c,e,f,h=this,i=h.kj,j=h.aMb,k=!1;if(h.canUndo()){h.Lz(i,!0);try{a=h._Lb,b=i.ITa,c=i.tables.findByName(j),e=d.Commands.bWa(i.name()),f=a[e],f&&(b.undo(f),g(i,c,a.resizeToRange,c.range()),b.wVa(f.uVa),k=!0)}finally{h.Mz(i,!0)}}return k},b}(l),d.Commands[n]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,D,b,c)}},E=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.cMb=c,d.aMb=c.tableName,d.cj=c.row,d.Jb=c.count,d.dMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k,l,m=this,n=!1;if(m.canExecute()){a=m.kj,b=a.ITa,c=m.aMb,e=m.cj,f=m.Jb,g=m.dMb,b.startTransaction(),m.Lz(a,!0);try{i=a.tables.findByName(c),i&&(j=i.Xj,i.Nia(e,f,g),n=!0,k=i.Xj,k-j===f&&h(a,i,o,e,f,g))}finally{m.Mz(a),l=d.Commands.bWa(a.name()),m.cMb[l]=b.endTransaction()}}return n},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,l,m=this,n=m.kj,o=!1;if(m.canUndo()){m.Lz(n,!0);try{a=m.cMb,b=n.ITa,c=d.Commands.bWa(n.name()),e=a[c],f=a.row,g=a.count,i=a.isAfter,e&&(b.undo(e),b.wVa(e.uVa),j=n.tables.findByName(m.aMb),j&&(l=i?f+1:f,j.ihc(l,g),j.NAb(),j.WNb(l,g,k(!0)),h(n,j,p,f,g,C,j.nKb())),o=!0)}finally{m.Mz(n,!0)}}return o},b}(l),d.Commands[o]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,E,b,c)}},F=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.cMb=c,d.aMb=c.tableName,d.cj=c.row,d.Jb=c.count,d.dMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,c=k.aMb,e=k.cj,f=k.Jb,g=k.dMb,b.startTransaction(),k.Lz(a,!0);try{i=a.tables.findByName(c),i&&(i.eMb(e,f,g,!1),h(a,i,o,e,f,g),k.cMb.row=e,k.cMb.count=f,l=!0)}finally{k.Mz(a),j=d.Commands.bWa(a.name()),k.cMb[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,l,m,n,o,q=this,r=q.kj,s=!1;if(q.canUndo()){q.Lz(r,!0);try{a=q.cMb,b=r.ITa,c=d.Commands.bWa(r.name()),e=a[c],f=a.row,g=a.count,i=a.isAfter,e&&(j=r.tables.findByName(q.aMb),l=j&&j.LZ(),m=void 0,n=i?f+1:f,l&&(o=j.dataRange(),m=l.slice(n-o.row,n-o.row+g)),b.undo(e),b.wVa(e.uVa),j&&(j.ihc(n,g),j.NAb(),j.WNb(n,g,k(!0)),h(r,j,p,f,g,i,m||j.nKb())),s=!0)}finally{q.Mz(r,!0)}}return s},b}(l),d.Commands[u]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,F,b,c)}},G=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.fMb=c,d.aMb=c.tableName,d.kJc=c.changeRows,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k,l,m,n=this,o=!1;if(n.canExecute()){a=n.kj,b=a.ITa,c=n.aMb,e=n.kJc,b.startTransaction(),n.Lz(a,!0);try{if(f=a.tables.findByName(c))for(g=e.length-1;g>=0;g--)i=e[g].row,j=e[g].count,k=f.Xj,f.STa(i,j),o=!0,l=f.Xj,k-l===j&&h(a,f,p,i,j,C,f.nKb())}finally{n.Mz(a),m=d.Commands.bWa(a.name()),n.fMb[m]=b.endTransaction()}}return o},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,k,l=this,m=l.kj,n=!1;if(l.canUndo()){l.Lz(m,!0);try{if(a=l.fMb,b=m.ITa,c=d.Commands.bWa(m.name()),e=a[c],f=l.kJc,e)for(b.undo(e),b.wVa(e.uVa),g=m.tables.findByName(l.aMb),g&&g.NAb(),n=!0,i=f.length-1;i>=0;i--)j=f[i].row,k=f[i].count,h(m,g,o,j,k,!1)}finally{l.Mz(m,!0)}}return n},b}(l),d.Commands[p]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,G,b,c)}},H=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.gMb=c,d.aMb=c.tableName,d.dj=c.col,d.Jb=c.count,d.dMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h,j,k,l,m=this,n=!1;if(m.canExecute()){a=m.kj,b=a.ITa,c=m.aMb,e=m.dj,f=m.Jb,g=m.dMb,b.startTransaction(),m.Lz(a,!0);try{h=a.tables.findByName(c),h&&(j=h.OZ,h.hMb(e,f,g),n=!0,k=h.OZ,k-j===f&&i(a,h,q,e,f,g))}finally{m.Mz(a),l=d.Commands.bWa(a.name()),m.gMb[l]=b.endTransaction()}}return n},b.prototype.undo=function(){var a,b,c,e,f,g,h,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{a=j.gMb,b=k.ITa,c=d.Commands.bWa(k.name()),e=a[c],f=a.col,g=a.count,e&&(b.undo(e),b.wVa(e.uVa),h=k.tables.findByName(j.aMb),h&&h.NAb(),l=!0,i(k,h,r,f,g))}finally{j.Mz(k,!0)}}return l},b}(l),d.Commands[q]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,H,b,c)}},I=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.iMb=c,d.aMb=c.tableName,d.dj=c.col,d.Jb=c.count,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h,j,k,l=this,m=!1;if(l.canExecute()){a=l.kj,b=a.ITa,c=l.aMb,e=l.dj,f=l.Jb,b.startTransaction(),l.Lz(a,!0);try{g=a.tables.findByName(c),g&&(h=g.OZ,g.TTa(e,f),m=!0,j=g.OZ,h-j===f&&i(a,g,r,e,f))}finally{l.Mz(a),k=d.Commands.bWa(a.name()),l.iMb[k]=b.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c,e,f,g,h,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{a=j.iMb,b=k.ITa,c=d.Commands.bWa(k.name()),e=a[c],f=a.col,g=a.count,e&&(b.undo(e),b.wVa(e.uVa),h=k.tables.findByName(j.aMb),h&&h.NAb(),l=!0,i(k,h,q,f,g,!1))}finally{j.Mz(k,!0)}}return l},b}(l),d.Commands[r]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,I,b,c)}},J=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.jMb=c,d.aMb=c.tableName,d}return b.prototype.execute=function(){var a,b,c,e,f,g=this,h=!1;if(g.canExecute()){a=g.kj,b=a.ITa,c=g.aMb,b.startTransaction(),g.Lz(a,!0);try{e=a.tables.findByName(c),e&&(a.tables.remove(e,3),h=!0)}finally{g.Mz(a),f=d.Commands.bWa(a.name()),g.jMb[f]=b.endTransaction()}}return h},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{a=g.jMb,b=h.ITa,c=d.Commands.bWa(h.name()),e=a[c],e&&(b.undo(e),b.wVa(e.uVa),f=h.tables.findByName(g.aMb),f&&f.NAb(),i=!0)}finally{g.Mz(h,!0)}}return i},b}(l),d.Commands[s]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,J,b,c)}},K=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this,e=d;return e.kMb=c,e.cj=c.row,e.dj=c.col,e.Yw=c.newValue,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.cj,e=h.dj,f=h.Yw,a.setFormula(c,e,f),f||a.setValue(c,e,null),i=!0}finally{h.Mz(a),g=d.Commands.bWa(a.name()),h.kMb[g]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=f.kMb,b=g.ITa,c=d.Commands.bWa(g.name()),e=a[c],e&&(b.undo(e),b.wVa(e.uVa),h=!0)}finally{f.Mz(g,!0)}}return h},b}(l),d.Commands[t]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,K,b,c)}},L=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this,e=d;return e.lMb=c,d.aMb=c.tableName,d}return b.prototype.execute=function(){var a,b,c,e,f,g=this,h=!1;if(g.canExecute()){a=g.kj,b=a.ITa,c=g.aMb,b.startTransaction(),g.Lz(a,!0);try{e=a.tables.findByName(c),e&&(e.showFooter(!0),h=!0)}finally{g.Mz(a),f=d.Commands.bWa(a.name()),g.lMb[f]=b.endTransaction()}}return h},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=f.lMb,b=g.ITa,c=d.Commands.bWa(g.name()),e=a[c],e&&(b.undo(e),b.wVa(e.uVa),h=!0)}finally{f.Mz(g,!0)}}return h},b}(l),d.Commands[v]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,L,b,c)}},d.Commands[w]={canUndo:!0,execute:function(a,b,c){var e,f,g,h,i,k,l;return b.cmd=w,m(b.row)&&m(b.count)?(e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0,1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.row,k=g.rowCount,l=h.footerIndex()===i,b.row=l?i-1:i,b.count=k,b.tableName=h.name(),b.isAfter=l),d.Commands.h4(a,E,b,c))):d.Commands.h4(a,E,b,c)}},d.Commands[x]={canUndo:!0,execute:function(a,b,c){if(b.cmd=x,m(b.row)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.row,k=g.rowCount,b.row=i,b.count=k,b.tableName=h.name(),b.isAfter=!0),d.Commands.h4(a,E,b,c))}return d.Commands.h4(a,E,b,c)}},d.Commands[y]={canUndo:!0,execute:function(a,b,c){var e,f,g,h,i,k,l,n,o,p;if(b.cmd=y,m(b.changeRows)&&m(b.changeRows)){for(e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,b.changeRows=[],k=0;k<f.length;k++){if(l=f[k],n=j(e,l),!n)return!1;if(g){if(g!==n)return!1}else g=n}for(k=0;k<f.length;k++)for(o=k+1;o<f.length;o++){if(l=f[k],p=f[o],l.row>=p.row&&l.row<=p.row+p.rowCount-1)return!1;if(l.row+l.rowCount-1>=p.row&&l.row+l.rowCount-1<=p.row+p.rowCount-1)return!1;if(l.row<=g.cj||l.row+l.rowCount>g.cj+g.Xj)return!1;if(p.row<=g.cj||p.row+p.rowCount>g.cj+g.Xj)return!1}for(f.sort(function(a,b){return a.row-b.row}),k=0;k<f.length;k++)l=f[k],h=l.row,i=l.rowCount,b.changeRows.push({row:h,count:i});return b.tableName=g.name(),d.Commands.h4(a,G,b,c)}return d.Commands.h4(a,G,b,c)}},d.Commands[z]={canUndo:!0,execute:function(a,b,c){if(b.cmd=z,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name(),b.isAfter=!1),d.Commands.h4(a,H,b,c))}return d.Commands.h4(a,H,b,c)}},d.Commands[A]={canUndo:!0,execute:function(a,b,c){if(b.cmd=A,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name(),b.isAfter=!0),d.Commands.h4(a,H,b,c))}return d.Commands.h4(a,H,b,c)}},d.Commands[B]={canUndo:!0,execute:function(a,b,c){if(b.cmd=B,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name()),d.Commands.h4(a,I,b,c))}return d.Commands.h4(a,I,b,c)}},d.Commands.mMb=function(a){a.register(n,d.Commands[n]),a.register(o,d.Commands[o]),a.register(u,d.Commands[u]),a.register(p,d.Commands[p]),a.register(q,d.Commands[q]),a.register(r,d.Commands[r]),a.register(s,d.Commands[s]),a.register(t,d.Commands[t]),a.register(v,d.Commands[v]),a.register(w,d.Commands[w]),a.register(x,d.Commands[x]),a.register(y,d.Commands[y]),a.register(z,d.Commands[z]),a.register(A,d.Commands[A]),a.register(B,d.Commands[B])}},"./dist/plugins/table/table-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/table/table.js"),g=c("./dist/plugins/table/table.ns.js"),h=c("./dist/plugins/table/table-util.js"),i=e.Common.j.Fa,j=null,k=Math.abs,l=10,m="tableResize",n=new e.Common.ResourceManager(g.SR),o=n.getResource.bind(n),p=h.Util.nMb,q=h.Util.oMb,r=h.Util.pMb,d.GC$.extend(d.iI.prototype,{oIb:function(a,b){var c=this.qgc(a,b);c&&b.setSelection(c.row,c.col,c.rowCount,c.colCount)},qgc:function(a,b){var c,e,g,h,k,l,m,n,o=b.getSelections(),p=a.tableSelectInfo;if(!b.isEditing()||b.getActiveRowIndex()===a.row&&b.getActiveColumnIndex()===a.col||b.endEdit(),c=p.table,e=0,g=0,c.NZ&&(e=1),c.MZ&&(g=1),h=j,k=p.action,l=b.Cw&&b.Cw.ahc(),!i(l)&&l.length>0&&(o=l),k===f.TableSelectionType.TABLE_ROW_SELECT)h=d.kf(a.row,c.dj,1,c.OZ);else if(k===f.TableSelectionType.TABLE_COL_SELECT){for(m=0;m<o.length;m++)if(n=o[m],n.col===a.col&&n.row===c.cj+g&&1===n.colCount&&n.rowCount===c.Xj-g-e){h=d.kf(c.cj,a.col,c.Xj,1);break}i(h)&&(h=d.kf(c.cj+g,a.col,c.Xj-g-e,1))}else if(k===f.TableSelectionType.TABLE_CORNER_SELECT){for(m=0;m<o.length;m++)if(n=o[m],n.col===c.dj&&n.row===c.cj+g&&n.colCount===c.OZ&&n.rowCount===c.Xj-g-e){h=d.kf(c.cj,c.dj,c.Xj,c.OZ);break}i(h)&&(h=d.kf(c.cj+g,c.dj,c.Xj-g-e,c.OZ))}else k===f.TableSelectionType.TABLE_SELECT&&(h=d.kf(c.cj,c.dj,c.Xj,c.OZ));return h},iJb:function(a,b){var c,d,e,f,g,h,i,k,m,n,o,r,s,t,u,v=this.kj,w=j;return v&&!v.options.isProtected&&!v.isEditing()&&b&&b.showResizeHandle()?(c=a.row,d=a.col,e=a.x,f=a.y,g=a.rowViewportIndex,h=a.colViewportIndex,i=p(v,b),k=q(v,b),c===i&&d===k&&(m=v.getCellRect(c,d,g,h),n=m.x,o=m.y,r=m.width,s=m.height,t=n+r,u=o+s,e>=t-l&&e<=t&&f>=u-l&&f<=u&&(w={x:e,y:f,table:b})),w):w},pIb:function(a){var b,c,d,e,f,g=this;g.qIb!==!0&&g.OG!==!0&&(b=g.kj,c=a.resizeTableHitInfo,d=c&&c.table,d&&!d.hJb()&&(g.qIb=!0,g.OG=!0,g.qMb=d,g.rMb=d.cj,g.sMb=d.dj,g.tMb=d.Xj,g.uMb=d.OZ,e=g.rMb+g.tMb-1,f=g.sMb+g.uMb-1,g.vMb=b.getCellRect(e,f),g.wMb=d.range(),g.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},g.qG()))},rIb:function(){var a,b=this,c=b.kj;b.rG&&b.qIb&&b.OG&&b.qMb&&(b.xMb(),b.yMb()&&(b.zMb=b.AMb(),b.BMb(),b.CMb(),a=b.DMb,a||(a=b.EMb()),a.equals(b.FMb)||(b.DMb=d.kf(b.FMb.row,b.FMb.col,b.FMb.rowCount,b.FMb.colCount),r(c,b.qMb,b.EMb(),b.FMb))),b.NG())},wIb:function(){var a,b=this,c=b.kj;return b.RG(),b.qIb&&b.OG&&b.FMb&&b.qMb?(b.qIb=!1,b.OG=!1,void(b.HMb()?(a=b.EMb(),b.IMb(),a.equals(b.FMb)?c.yl.JMb():c.wu().execute({cmd:m,sheetName:c.name(),tableName:b.qMb.name(),resizeToRange:b.FMb}),b.GMb()):(b.GMb(),c.yl.JMb()))):void b.GMb()},EMb:function(){var a=this.qMb;return d.kf(a.cj,a.dj,a.Xj,a.OZ)},xMb:function(){var a=this,b=a.fH(),c=a.gH();a.KMb=b,a.LMb=c},yMb:function(){var a=this,b=a.rMb,c=a.sMb,d=a.KMb,e=a.LMb,f=a.qMb,g=f.MZ,h=g?b+1:b,i=c;return d>=h&&e>=i},AMb:function(){var a,b=this,c=b.$F,d=b.vMb,e=d.x+d.width,f=d.y+d.height,g=c.x,h=c.y,i=k(f-h),j=k(e-g);return a=i>=j?h<f?2:3:g<e?0:1},BMb:function(){var a=this,b=a.rMb,c=a.sMb,e=a.KMb,f=a.LMb,g=a.zMb,h=a.tMb,i=a.uMb;switch(g){case 0:case 1:i=k(f-c)+1;break;case 2:case 3:h=k(e-b)+1}a.FMb?(a.FMb.rowCount=h,a.FMb.colCount=i):a.FMb=d.kf(b,c,h,i)},CMb:function(){var a=this,b=a.kj;b.yl.JMb(),a.wMb=a.MMb()},MMb:function(){var a=this,b=a.FMb,c=b.row,e=b.col,f=b.rowCount,g=b.colCount;return d.kf(c,e,f,g)},IMb:function(){var a=this,b=a.qMb,c=a.zMb;2===c&&b.NZ&&(a.FMb.rowCount+=1)},HMb:function(){var a=this,b=a.kj,c=!1,d=b.ITa,e=b.tables,f=a.qMb,g=a.FMb,h=g.row,i=g.col,j=g.rowCount,k=g.colCount,l=a.KMb,m=a.LMb,n=p(b,f),r=q(b,f),s=a.zMb,t=f.xr;return n&&r?(d.MTa(h,i,j,k)||d.qu(h,i,j,k)?b.Os(6,o().Exp_TableResizeToSpan):t&&t.isFiltered()?2===s?b.Os(6,o().Exp_TableResizeWithHidden):3===s&&f.NZ?b.Os(6,o().Exp_TableResizeWithFilter):c=!0:2===s&&a.NMb(n,l)||0===s&&a.OMb(r,m)?b.Os(6,o().Exp_TableResizeWithHidden):1===s&&(e.rn(h,r+1,j,m-r)||e.HZ(h,r+1,j,m-r))||3===s&&(e.rn(n+1,i,l-n,k)||e.HZ(n+1,i,l-n,k))?b.Os(6,o().Exp_TableResizeToTable):c=!0,c):c},NMb:function(a,b){var c=this,d=c.kj,e,f=!1;for(e=a;e>b;e--)if(d.getRowHeight(e)<=0){f=!0;break}return f},OMb:function(a,b){var c=this,d=c.kj,e,f=!1;if(!f)for(e=a;e>b;e--)if(d.getColumnWidth(e)<=0){f=!0;break}return f},GMb:function(){var a=this;a.qIb=!1,a.OG=!1,a.rG=j,a.FMb=j,a.DMb=j}})},"./dist/plugins/table/table-render.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.GC$.extend,f="tableRender",e(d.oJ.prototype,{JMb:function(){var a=this,b=a.kj;b.Xq>0||a.im()}}),d.Worksheet.$n(f,{paintAdornment:function(a){var b=this,c=a.ctx,d=b.mm;d&&d.rG&&d.qIb&&g(b,c,d.iH(),d.jH())}});function g(a,b,c,d){var e=a.mm,f=e.FMb,g=a.getRangeRect(c,d,f);b.strokeStyle=a.getSelectionBorderColor(),b.strokeRect(g.x,g.y,g.width,g.height)}},"./dist/plugins/table/table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.GC$.each,f=d.GC$.isEmptyObject,g=d.Ul.Ol,h=JSON.stringify,i=JSON.parse,j=d.Ul.Pl,k=Math.floor,l=void 0,m=null,n="headerRowStyle",o="footerRowStyle",p="wholeTableStyle",q="highlightLastColumnStyle",r="highlightFirstColumnStyle",s="firstRowStripStyle",t="secondRowStripStyle",u="firstColumnStripStyle",v="secondColumnStripStyle",w="firstHeaderCellStyle",x="lastHeaderCellStyle",y="firstFooterCellStyle",z="lastFooterCellStyle",A=[n,o,p,q,r,s,t,u,v,w,x,y,z],B="firstRowStripSize",C="secondRowStripSize",D="firstColumnStripSize",E="secondColumnStripSize",F=[B,C,D,E],G="name",H="bold 11pt calibri",I="borderLeft",J="borderTop",K="borderRight",L="borderBottom",M="borderHorizontal",N="borderVertical",O=["backColor","foreColor","font",I,J,K,L,M,N,"textDecoration"],P=function(){function a(a,b,c,d,f,g,h,i,j,k){var l=this,m=arguments;e(O,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,f){var h=this;c&&g(h[I])&&!g(a[I])&&(a[I]=h[I],a[I].level=20),b&&g(h[J])&&!g(a[J])&&(a[J]=h[J],a[J].level=20),f&&g(h[K])&&!g(a[K])&&(a[K]=h[K],a[K].level=20),d&&g(h[L])&&!g(a[L])&&(a[L]=h[L],a[L].level=20),b||!g(h[M])||g(a[J])||(a[J]=h[M],a[J].level=20),d||!g(h[M])||g(a[L])||(a[L]=h[M],a[L].level=20),c||!g(h[N])||g(a[I])||(a[I]=h[N],a[I].level=20),f||!g(h[N])||g(a[K])||(a[K]=h[N],a[K].level=20),e(O,function(b,c){c.indexOf("border")>=0||g(h[c])&&!g(a[c])&&(a[c]=h[c])})},a.prototype.Uo=function(){var b=new a,c=h(this.toJSON());return b.fromJSON(i(c)),b},a.prototype.toJSON=function(){var a=this,b={};return e(O,function(c,d){var e=a[d],g=e&&e.toJSON?e.toJSON():e;b[d]=f(g)?l:g}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;e(O,function(e,f){var h,i=a[f];g(i)&&(f.indexOf("border")>=0?(h=new d.LineBorder,h.fromJSON(i,b),c[f]=h):c[f]=i)})}},a}(),b.TableStyle=P,Q=function(){function a(){}return a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},e(A,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),e(F,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),f(a)?l:a)},a.prototype.fromJSON=function(a,b){var c,d,f,h;function i(a,b){a.name(b.name()),e(F,function(c,d){a[d](b[d]())}),e(A,function(c,d){var e=b[d]();a[d](e?e.Uo():m)}),a.builtInName(b.builtInName(),!1)}if(a){if(c=this,d=a.buildInName)return void i(c,T[d.toLowerCase()]);f=a.name,h=g(f)?f:a.Cj,g(h)&&c.name(h,!1),e(F,function(b,d){var e=a[d]!==l?a[d]:a["_"+d];e&&c[d](e,!1)}),e(A,function(d,e){var f,g=a[e]!==l?a[e]:a["_"+e];g&&(f=new P,f.fromJSON(g,b),c[e](f,!1))})}},a}(),b.TableTheme=Q,Q.prototype.name=j(G),Q.prototype.builtInName=j("builtInName"),e(A,function(a,b){Q.prototype[b]=j(b)}),e(F,function(a,b){Q.prototype[b]=j(b,1)}),R="white",S="black";function V(a,b){return isNaN(b)?b:new d.LineBorder(a,b)}function W(a,b,c,d,e,f,g,h,i,j){var k=new P;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=H),e&&(k.borderLeft=V(a,e)),f&&(k.borderTop=V(a,f)),g&&(k.borderRight=V(a,g)),h&&(k.borderBottom=V(a,h)),i&&(k.borderHorizontal=V(a,i)),j&&(k.borderVertical=V(a,j)),k}function X(a){return 0===a?"Text 1":"Accent "+a}function Y(a){var b,c=a-1,d=m,e=k(c/7);return e>=0&&e<3&&(d=[Z,$,_][e](c%7),b="Light"+a,d.name&&d.name(b),d.builtInName&&d.builtInName(b)),d}function Z(a){var b=X(a),c=b+" 80",d=new Q;return d[n](W(b,0,b,1,0,0,0,1)),d[p](W(b,0,b,0,0,1,0,1)),d[s](W(b,c)),d[r](W(b,0,b,1)),d[q](W(b,0,b,1)),d[u](W(b,c)),d[o](W(b,0,b,1,0,1)),d}function $(a){var b=X(a),c=new Q;return c[n](W(b,b,R,1)),c[p](W(b,0,0,0,1,1,1,1)),c[s](W(b,0,0,0,0,1)),c[t](W(b,0,0,0,0,1)),c[u](W(b,0,0,0,1)),c[v](W(b,0,0,0,1)),c[r](W(b,0,0,1)),c[q](W(b,0,0,1)),c[o](W(b,0,0,1,0,6)),c}function _(a){var b=X(a),c=b+" 80",d=new Q;return d[n](W(b,0,0,1,0,0,0,2)),d[p](W(b,0,0,0,1,1,1,1,1,1)),d[s](W(b,c)),d[u](W(b,c)),d[r](W(b,0,0,1)),d[q](W(b,0,0,1)),d[o](W(b,0,0,1,0,6)),d}function aa(a){var b,c=a-1,d=m,e=k(c/7);return e>=0&&e<4&&(d=[ba,ca,da,ea][e](c%7),b="Medium"+a,d.name(b),d.builtInName(b)),d}function ba(a){var b=X(a),c=b+" 20",d=b,e=b+" 80",f=new Q;return f[n](W(c,d,R,1)),f[p](W(c,0,0,0,1,1,1,1,1)),f[s](W(c,e)),f[u](W(c,e)),f[r](W(c,0,0,1)),f[q](W(c,0,0,1)),f[o](W(c,0,S,1,0,6)),f}function ca(a){var b=X(a),c=R,d=b,e=b+" 60",f=b+" 80",g=new Q;return g[n](W(c,d,R,1,0,0,0,2,0,1)),g[p](W(c,f,0,0,0,0,0,0,1,1)),g[s](W(c,e)),g[u](W(c,e)),g[r](W(c,d,R,1)),g[q](W(c,d,R,1)),g[o](W(c,d,R,1,0,2,0,0,0,1)),g}function da(a){var b=X(a),c="#D3D3D3",e=b,f=c,g=0===a?S:c,h=new Q;return h[n](W(S,e,R,1,0,2,0,2)),h[p](W(g,0,0,0,1,new d.LineBorder(S,2),1,new d.LineBorder(S,2),0===a?1:0,1)),h[s](W(g,f)),h[u](W(g,f)),h[r](W(g,e,R)),h[q](W(g,e,R)),h[y](W(g,e,R,1)),h[z](W(g,e,R,1)),h[o](W(S,0,S,0,0,6)),h}function ea(a){var b=X(a),c=b,e=b+" 40",f=b+" 80",g=b+" 60",h=b+" 80",i=new Q;return i[n](W(e,f,S,1,1,1,1,1,0,1)),i[p](W(e,f,0,0,1,1,1,1,1,1)),i[s](W(e,g)),i[u](W(e,g)),i[r](W(e,0,0,1)),i[q](W(e,0,0,1)),i[o](W(e,h,S,1,1,new d.LineBorder(c,2),1,1,0,1)),i}function fa(a){var b,c=a-1,d=m,e=k(c/7);return e>=0&&e<2&&(d=[ga,ha][e](c%7),b="Dark"+a,d.name(b),d.builtInName(b)),d}function ga(a){var b=X(a),c=S,d=0===a?b+" 25":b+" -25",e=0===a?b+" 50":b,f=0===a?b:b+" -50",g=new Q;return g[n](W(R,c,R,1,0,0,0,2)),g[p](W(b,e,R)),g[s](W(b,d)),g[u](W(b,d)),g[r](W(R,d,R,1,0,0,2)),g[q](W(R,d,R,1,2)),g[o](W(R,f,R,1,0,2)),g}function ha(a){var b,c,d,e,f,g;function h(a,b){if(a<0||a>3)return"";var c={tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]};return c[b][a]}return b=X(a),c=h(a,"headerColor"),d=h(a,"stripColor"),e=h(a,"tableBackground"),f=e,g=new Q,g[n](W(b,c,R)),g[p](W(b,e)),g[s](W(b,d)),g[u](W(b,d)),g[r](W(b,0,0,1)),g[q](W(b,0,0,1)),g[o](W(S,f,0,1,0,6)),g}for(T=function(){function a(){}return a}(),b.TableThemes=T,U=1;U<=28;U++)U<=21&&(T["light"+U]=Y(U)),U<=11&&(T["dark"+U]=fa(U)),T["medium"+U]=aa(U)},"./dist/plugins/table/table-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("SheetsCalc"),f=c("CalcEngine"),g=c("Common"),h=c("./dist/plugins/table/table.ns.js"),i=d.Ul.Ol,j=null,k=void 0,l=Math.max,m=g.Common.j.Fa,n=0,o=new g.Common.ResourceManager(h.SR),p=o.getResource.bind(o);function q(a){throw Error(a)}function r(a,b,c,d,e){!d&&e&&(d=E(a,e,b,c)),f&&a._u(b,c,d,e)}function s(a,b,c,d){a.setValue(b,c,d)}function t(a){a.suspendPaint()}function u(a){a.resumePaint()}function v(a){return a.Cf().ih()}function w(a){f&&a.suspendCalcService()}function x(a,b){f&&a.resumeCalcService(b)}function y(a){a&&(t(a),a.suspendEvent(),w(a))}function z(a){a&&(x(a),a.resumeEvent(),u(a))}function A(a){return a.rowCount}function B(a){return a.colCount}function C(a){return a&&!(/\d/.test(a[0])||/[\s\+\-\*\\:%!\[\]]/.test(a)||["C","c","R","r"].indexOf(a)!==-1||/^[A-Za-z]{1,3}(\$)?\d+$/.test(a)||/^[Rr]\d*[Cc]\d*$/.test(a)||a.length>=255)}function D(a,b,c,d,e){var f,g=a.yj();return g.DLb=e,f=a.Wu.parse(g,b,c,d,!1,!1,!1),delete g.DLb,f}function E(a,b,c,d,e){return e=e===k||e,a.Wu.unparse(a.yj(),b,c,d,!1,e)}function F(a){var b,c,d,e;return!!a&&(C(a)||q(p().Exp_TableNameInvalid),b=this,c=b.name(),d=b.tc,a!==c&&(!d||(e=d.findByName(a),!e||b===e)))}function G(a,b,c,d,e){var f,g,h,i;for(f=c;f>=b;f--)for(h=d;h<=e;h++){if(g=a.Iq(f,h),J(g))return f;if(I(a,f,h))return f;if(i=a.ITa.findSpan(f,h))return i.row+i.rowCount-1}return-1}function H(a,b,c,d,e){var f,g,h,i;for(g=e;g>=d;g--)for(f=b;f<=c;f++){if(h=a.Iq(f,g),J(h))return g;if(I(a,f,g))return g;if(i=a.ITa.findSpan(f,g))return i.col+i.colCount-1}return-1}function I(a,b,c){var d=a.getValue(b,c),e,f;return!(d===j||!i(d))||(!!(e=a.getSparkline&&a.getSparkline(b,c))||(f=a.Iq(b,c),J(f)))}function J(a){return!(!a||!(a.backColor||a.backgroundImage||a.borderBottom||a.borderLeft||a.borderRight||a.borderTop||a.diagonalDown||a.diagonalUp))}function K(a,b,c,d,e,f,g,h){return a>=e&&!(b===g&&b+d-1===h)&&(b<g&&b+d>=g||b>=g&&b<=h&&b+d-1>h)}function L(a,b,c,d,e,f,g,h){return b>=g&&!(a===e&&a+c-1===f)&&(a<e&&a+c>=e||a>=e&&a<=f&&a+c-1>f)}function M(a,b,c){return{col:b,leadingCellRow:c,row:a}}function N(a,b,c){var d=j,e=b.cj,f=b.endRow();for(c&&(f-=b.NZ?1:0);f>=e&&a.getRowHeight(f)<=0;)f--;return f>=e&&(d=f),d}function O(a,b){for(var c=j,d=b.dj,e=b.endColumn();e>=d&&a.getColumnWidth(e)<=0;)e--;return e>=d&&(c=e),c}function P(a){var b,c,d,e,f=a.ITa,g=f.XTa(3).dataTable,h=f.getLastNonNullRow(3,!0),i=a.getRowCount(),j=a.getColumnCount(),k=-1;for(d=i-1;d>-1;d--)if(b=g[d])for(e=0;e<j;e++)if(c=b[e],c&&!m(c.value))return l(d,h);return l(k,h)}function Q(a,b){var c,e,f,g=b.tc,h=b.cj,i=b.Xj,j=h+i-1,k=b.dj,m=k+b.OZ-1,n=P(a),o=g?g.PMb():-1;return n=l(n,o),c=j,n>j&&(e=j+1,f=new d.Range(e,k,n-j,m-k+1),c=l(G(a,e,n,k,m),g.PMb(f))),c}function R(a){var b,c,d,e,f=a.ITa,g=f.XTa(3).dataTable,h=f.getLastNonNullCol(3,!0),i=a.getRowCount(),j=a.getColumnCount(),k=-1;for(d=j-1;d>-1;d--)for(e=0;e<i;e++)if(b=g[e],c=b&&b[d],c&&!m(c.value))return l(d,h);return l(k,h)}function S(a,b){var c,e,f,g=b.tc,h=b.cj,i=h+b.Xj-1,j=b.dj,k=b.OZ,m=j+k-1,n=R(a),o=g?g.QMb():-1;return n=l(n,o),c=m,n>m&&(e=m+1,f=new d.Range(h,e,i-h+1,n-m),c=l(H(a,h,i,e,n),g.QMb(f))),c}function T(a,b,c,d,e,f,g,h,i,j){var k,l,m=a.getRowCount()-1,n=a.getColumnCount()-1,o=a.ITa.getSpans(),r=b.tc&&b.tc.l$;return!h&&(!i&&m-d<g||i&&n-f<g)?(j||q(p().Exp_TableAddRowNoEnoughRoom),!0):(k=i?L:K,l=o.some(function(a){var b=a.row,g=a.col,h=a.rowCount,i=a.colCount;return k(b,g,h,i,c,d,e,f)}),l?j||q(p().Exp_TableAddRowIntersectSpan):r&&(l=r.some(function(a){var b=a.cj,g=a.dj,h=a.Xj,i=a.OZ;return k(b,g,h,i,c,d,e,f)}),l&&!j&&q(p().Exp_TableAddRowIntersectTable)),l)}function U(a,b,c){var e,f,g,h=b.row,i=b.col,j=h+b.rowCount,l=i+b.colCount;for(e=h;e<j;e++)for(f=i;f<l;f++)if(g=a.getCell(e,f),g.value()||a.ITa.findSpan(e,f)){if(c&&c.equals(new d.Range(g.row,g.col,1,1)))continue;return new d.Range(e,f,1,1)}return k}function V(a,b){return{action:b,table:a}}function W(a,b){var c=a.cj;return b-(a.MZ?c+1:c)}function X(a,b){var c=a.dj;return b-c}function Y(a){var b=n;return a&&n++,b}function Z(a){return"string"==typeof a}function $(a,b,c,e){var f={sheet:a,table:b,oldRange:c,newRange:e};a.Wq(d.Events.TableResizing,f)}function _(a,b,c,e){var f={sheet:a,table:b,oldRange:c,newRange:e};a.Wq(d.Events.TableResized,f)}function aa(a,b,c,e,f,g,h){var i={sheet:a,table:b,propertyName:c,row:W(b,e),count:f};m(g)||(i.isAfter=g),h&&(i.deletedItem=h),a.Wq(d.Events.TableRowsChanged,i)}function ba(a,b,c,e,f,g){var h={sheet:a,table:b,propertyName:c,col:e-b.dj,count:f};m(g)||(h.isAfter=g),a.Wq(d.Events.TableColumnsChanged,h)}function ca(a,b,c){var d=0;if(a.VZ(b,c))for(d=2;a.VZ(b+d,d);)d++;return d>0&&(b+=d),b}function da(a){return a&&"="===a[0]}function ea(a){var b,c,d,f=-1;if(a)for(b=a.arguments,c=void 0,d=0;d<b.length;d++)if(c=b[d],c instanceof e.xzb){f=d;break}return f}function fa(a,b,c){var d=a.dataRange(),e=d.row,f=d.col,g=c?e:f;return g+b}function ga(a){var b=a;return a&&"="===a[0]&&(b=a.slice(1)),b}function ha(a,b){var c,d;for(d=0;d<a.length;d++)if(c=a[d],c&&b===c.col)return c;return j}function ia(a,b){var c,d,e;if(!b)return null;for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)if(a.tables&&(e=a.tables.find(c,d)))return e;return null}function ja(a,b){return b?a.tables.s$(b.row,b.col,b.rowCount,b.colCount):null}function ka(a){return m(a)||("string"!=typeof a&&(a+=""),a=a.replace(/\r\n?/g,"\n")),a}function la(a){return a===k}b.Util={throwError:q,setFormulaToSheet:r,setValue:s,suspendPaint:t,resumePaint:u,ih:v,suspendCalcService:w,resumeCalcService:x,RMb:y,SMb:z,getRowCount:A,getColCount:B,isValidTableName:C,formulaToExpression:D,expressionToFormula:E,checkTableName:F,TMb:M,nMb:N,oMb:O,UMb:Q,VMb:S,WMb:T,XMb:U,YMb:V,ZMb:W,$Mb:X,_Mb:Y,aNb:Z,pMb:$,$Lb:_,PIb:aa,QIb:ba,bNb:ca,bW:da,cNb:ea,dNb:fa,eNb:ga,fNb:ha,_getTable:ia,Pda:ja,jhc:ka,gNb:la}},"./dist/plugins/table/table.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/table/table.interface.js"),c("./dist/plugins/table/table-event.js"),c("./dist/plugins/table/table-render.js"),c("./dist/plugins/table/table-action.js"),c("./dist/plugins/table/table-util.js"),d(c("./dist/plugins/table/table-theme.js")),d(c("./dist/plugins/table/table.js")),d(c("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Fb=this&&this.__assign||function(){return Fb=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Fb.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("SheetsCalc"),f=c("Common"),g=c("CalcEngine"),h=c("Filters"),i=c("Bindings"),j=c("./dist/plugins/table/table.ns.js"),k=c("./dist/plugins/table/table-theme.js"),l=c("./dist/plugins/table/table-util.js"),m=d.Ul.Pl,n=d.Ul.Ol,o=d.Ul.bc,p=d.GC$.inArray,q=d.GC$.each,r=d.GC$.isEmptyObject,s=f.Common.j.Fa,t=f.Common.l,u=f.Common.k.Bb,v=f.Common.k.ac,w=f.Common.D,x=l.Util.throwError,y=l.Util.setFormulaToSheet,z=l.Util.setValue,A=l.Util.suspendPaint,B=l.Util.resumePaint,C=l.Util.ih,D=l.Util.suspendCalcService,E=l.Util.resumeCalcService,F=l.Util.getRowCount,G=l.Util.getColCount,H=l.Util.checkTableName,I=l.Util.isValidTableName,J=l.Util.formulaToExpression,K=l.Util.expressionToFormula,L=l.Util.TMb,M=l.Util.nMb,N=l.Util.oMb,O=l.Util.UMb,P=l.Util.VMb,Q=l.Util.WMb,R=l.Util.XMb,S=l.Util.YMb,T=l.Util.ZMb,U=l.Util.$Mb,V=l.Util._Mb,W=l.Util.aNb,X=l.Util.RMb,Y=l.Util.SMb,Z=l.Util.PIb,$=l.Util.QIb,
_=l.Util.bNb,aa=l.Util.bW,ba=l.Util.cNb,ca=l.Util.dNb,da=l.Util.eNb,ea=l.Util.fNb,fa=l.Util.Pda,ga=l.Util.jhc,ha=l.Util.gNb,ia=null,ja=void 0,ka=Math.min,la=Math.ceil,ma=Math.max,na=JSON.stringify,oa=JSON.parse,pa="name",qa="cellType",ra="value",sa="formatter",ta="highlightFirstColumn",ua="highlightLastColumn",va="bandRows",wa="bandColumns",xa="autoGenerateColumns",ya="headerRowStyle",za="footerRowStyle",Aa="wholeTableStyle",Ba="highlightLastColumnStyle",Ca="highlightFirstColumnStyle",Da="firstRowStripStyle",Ea="secondRowStripStyle",Fa="firstColumnStripStyle",Ga="secondColumnStripStyle",Ha="firstHeaderCellStyle",Ia="lastHeaderCellStyle",Ja="firstFooterCellStyle",Ka="lastFooterCellStyle",La="firstRowStripSize",Ma="secondRowStripSize",Na="firstColumnStripSize",Oa="secondColumnStripSize",Pa=".table",Qa="Column",Ra="id",Sa="dataField",Ta="footerFormula",Ua="dataAreaFormulaStr",Va="isArrayFormula",Wa="dataAreaFormula",Xa="footerValue",Ya="footerRowStyles",Za=[Ra,pa,qa,ra,sa,Sa,Ta,Wa,Xa],$a=4,_a=2,ab="table",bb="tableResize",cb="#485DB1",db="tableInsertRows",eb="DoInsertRows",fb="tableShowFooter",gb="tableDeleteRows",hb="tableInsertColumns",ib="tableDeleteColumns",jb="collection",kb="tableColumn",lb="property",mb="dataSource",nb="rowsChange",ob="range",pb="columns",qb="tableExpression",rb="sheetExpression",sb="number",tb="string",ub=new f.Common.ResourceManager(j.SR,"Tables"),vb=ub.getResource.bind(ub),function(a){a.TABLE_ROW_SELECT="tableRowSelect",a.TABLE_COL_SELECT="tableColSelect",a.TABLE_CORNER_SELECT="tableCornerSelect",a.TABLE_SELECT="tableSelect"}(wb=b.TableSelectionType||(b.TableSelectionType={})),function(a){a[a.deleted=0]="deleted",a[a.dirty=1]="dirty"}(xb||(xb={}));function Gb(a,b){var c,d,e=!1;if(s(a[b]))e=!0;else for(c=a.length-1;c>b;c--){if(d=c-1,s(a[d])){e=!0;break}a[c]=a[d]}return e}function Hb(a,b,c){var d=a.parent,f=C(a);function g(b,d){q(b,function(b,g){var h=g.getExpression(),i=e.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(h,d,-1,-1,c);i!==h&&(g.fg(i),f.invalidName(a.yj(),g.getName()))})}d?(g(d.getCustomNames(),b),q(d.sheets,function(a,c){g(c.getCustomNames(),b)})):g(a.getCustomNames(),b),f.onAfterRemoveTable(b,c)}function Ib(a,b){var c={position:d.ButtonPosition.right,imageType:d.ButtonImageType.dropdown,visibility:d.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},e=[{text:vb().Table_None,value:null},{text:vb().Table_Average,value:"=SUBTOTAL(101,["+b+"])"},{text:vb().Table_Count,value:"=SUBTOTAL(103,["+b+"])"},{text:vb().Table_Count_Numbers,value:"=SUBTOTAL(102,["+b+"])"},{text:vb().Table_Max,value:"=SUBTOTAL(104,["+b+"])"},{text:vb().Table_Min,value:"=SUBTOTAL(105,["+b+"])"},{text:vb().Table_Sum,value:"=SUBTOTAL(109,["+b+"])"},{text:vb().Table_StdDev,value:"=SUBTOTAL(107,["+b+"])"},{text:vb().Table_Var,value:"=SUBTOTAL(110,["+b+"])"}],f={items:e},g=new d.Style;return g.cellButtons=[c],g.dropDowns=[{type:d.DropDownType.list,option:f,submitCommand:"tableTotalRowFormula"}],g}d.Worksheet.$n(ab,{priority:2e3,init:function(){var a=this;a.tables=a.ITa.noa,a.unbind(Pa),a.bind(d.Events.BeforeDragDrop+Pa,function(b,c){var d,e=a,f=a.tables,g=vb().Exp_DragDropChangePartOfTable,h=c.fromRow,i=c.fromColumn,j=F(c),k=c.columnCount,l=e.mm.gA,m=l.row,n=l.col,o=c.isDragInsert,p=c.isDragCopy,q=ia;!o||h!==-1&&i!==-1||(i>=0?(a.isDragCopy&&(n<=i||n>=i+k)||!p&&(n<i||n>i+k))&&(d=!1,f.HZ(-1,n,-1,1)&&(d=!0,q=vb().Exp_DragDropShiftTableCell),d||p||!f.HZ(-1,i,-1,k)||(q=g)):h>=0&&i<0&&(p&&(m<=h||m>=h+j)||!p&&(m<h||m>h+j))&&!p&&f.HZ(h,-1,j,-1)&&(q=g)),c.invalidMessage=q}),a.bind(d.Events.RowChanged+Pa,function(b,c){var d=a.tables,e=d.$m,f=c.propertyName;"isVisible"===f?(c.newValue===!1?e[c.row]=0:e[c.row]=ja,d.hNb(c.row)):"height"===f&&(e[c.row]=ja,d.hNb(c.row))}),a.bind(d.Events.RowHeightChanged+Pa,function(b,c){var d,e,f,g,h,i=a.tables,j=i.$m;for(d=0,e=c.rowList;d<e.length;d++)f=e[d],j[f]=ja,g=c.sheet,h=g.getRowHeight(f),i.hNb(f,h>0)}),a.bind(d.Events.ColumnChanged+Pa,function(b,c){var d=a.tables,e=d.an;"isVisible"===c.propertyName?(c.newValue===!1?e[c.col]=0:e[c.col]=ja,d.iNb(c.col)):"width"===c.propertyName&&(e[c.col]=ja,d.iNb(c.col))}),a.bind(d.Events.ColumnWidthChanged+Pa,function(b,c){var d,e,f,g=a.tables,h=g.an;for(d=0,e=c.colList;d<e.length;d++)f=e[d],h[f]=ja,g.iNb(f)}),a.bind(d.Events.RangeFiltered+Pa,function(b,c){var d,e=a.tables,f=e.$m,g=c.sheet.xr.range;for(d=0;d<g.rowCount;d++)f[g.row+d]=ja,e.hNb(g.row+d)}),a.bind(d.Events.TableFiltered+Pa,function(b,c){var d,e=a.tables,f=e.$m,g=c.table.range();for(d=0;d<g.rowCount;d++)f[g.row+d]=ja,e.hNb(g.row+d)}),a.bind(d.Events.TableFilterCleared+Pa,function(b,c){var d=a.tables;d.Nm()})},resetBinding:function(a){this.tables.IZ()},initBinding:function(a){var b,c,d,e,f=this,g=f.tables;for(g.IZ(),D(f),b=g.all(),c=0,d=b.length;c<d;c++)e=b[c],e&&e.JZ();E(f)},dispose:function(a){a.clearCache!==!1&&(this.unbind(Pa),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var a=this.tables;a&&a.Xec()},onGroupChanged:function(a){var b,c,d=this,e=d.tables;if(a.fromSetCollapsed)for(b=a.isRow?e.$m:e.an,c=a.start;c<=a.end;c++)b[c]=ja,a.isRow?e.hNb(c):e.iNb(c)},onLayoutChanged:function(a){var b,c=this,d=a.changeType,e=a.row,f=a.rowCount,g=a.col,h=a.colCount,i=c.tables;"addRows"===d?(i.rI(e,f),i.Nm()):"addRows2"===d?i.KZ(e,f):"deleteRows"===d?(i.GR(e,f),i.Nm()):"addColumns"===d?(i.tI(g,h),i.Nm()):"deleteColumns"===d?(i.HR(g,h),i.Nm()):"addColumns2"===d||"deleteColumns2"===d?i.khc(g):"clear"===d?(b=a.sheetArea,a.ignoreTable||3!==b&&!s(b)||i.$b(e,g,f,h,a.type)):"setRowCount"===d?i.Nm():"setColumnCount"===d&&i.Nm()},toJson:function(a,b){var c,d,e,f,g;function h(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.tables.all();for(c=0,d=p.length;c<d;c++)if(e=p[c],f=e.LZ(),g=e.dataRange(),h=g.row,i=g.col,j=h+F(g)-1,k=i+G(g)-1,f)for(l=h;l<=j;l++)for(m=i;m<=k;m++)n=e.ge(l,m),n.gt&&(o=n.Qb,t.Ska(o)&&(o=t.Daa(o)),a.qI(b,l,m,o))}c=this,d=c.tables,e=b&&b.ignoreStyle,f=b&&b.newWorkSheetName,e||(d&&(a.tables=d.toJSON(f)),b&&b.includeBindingSource&&(g=a.data,g.dataTable=g.dataTable||{},h(c,g.dataTable)))},fromJson:function(a,b,c){var d=this,e=d.tables,f=a.tableManager,g=b?f&&f.tables:a.tables,h=c&&c.ignoreStyle;n(g)&&!h&&e&&e.fromJSON(g,b)},fromJsonAfterFormula:function(a,b,c){var d=this,e=d.tables;e.all().forEach(function(a){a.formulaFromJSON()})},lastNonNullRowAndCol:function(){var a,b,c,d,e,f,g=this,h=g.tables,i=0,j=0,k=h.all();if(k)for(a=0,b=k.length;a<b;a++)c=k[a],c&&(d=c.range(),e=d.row+F(d)-1,f=d.col+G(d)-1,e>i&&(i=e),f>j&&(j=f));return{lastNonNullRow:i,lastNonNullCol:j}},paintCell:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;a.isPrinting||a.sheetArea!==d.SheetArea.viewport||t.options.isProtected||(b=t.tables,c=a.ctx,e=a.cell,f=e.row,g=e.col,h=b.find(f,g),h&&h.showResizeHandle()&&!h.hJb()&&(i=M(t,h),j=N(t,h),f===i&&g===j&&(k=e.x,l=e.y,m=e.width,n=e.height,o=t.zoom(),p=la($a*o),q=la(_a*o),r=k+m,s=l+n,c&&m>0&&n>0&&(c.save(),c.rect(k,l,m,n),c.clip(),c.fillStyle=cb,c.beginPath(),c.moveTo(r-p,s),c.lineTo(r,s),c.lineTo(r,s-q),c.lineTo(r-p,s-q),c.fill(),c.beginPath(),c.moveTo(r,s-q),c.lineTo(r-q,s-q),c.lineTo(r-q,s-p),c.lineTo(r,s-p),c.fill(),c.restore()))))},composeTableFooterList:function(a){var b=a.table,c=a.row,d=a.col,e=a.style;b.jNb(c,d,e)}}),d.Worksheet.prototype.PIb=function(a,b,c,d,e,f){var g=f?ja:a.nKb();Z(this,a,b,c,d,e,g)},d.Worksheet.prototype.QIb=function(a,b,c,d,e){$(this,a,b,c,d,e)},d.Workbook.prototype.jga=function(a){var b,c,d,e=this.sheets;if(e)for(d=0;d<e.length;d++)if(c=e[d].tables,c&&(b=c.findByName(a)))return b;return ia},yb=function(){function a(a,b,c,d,e,f,g){var h,i=this;for(i.MZ=!g||g.showHeader===ja||g.showHeader,i.NZ=!(!g||g.showFooter===ja)&&g.showFooter,i.kNb=!(!g||g.useFooterDropDownList===ja)&&g.useFooterDropDownList,i.lNb=!(!g||g.showResizeHandle===ja)&&g.showResizeHandle,i.mNb=[],i.wq=ia,i.xr=ia,i.tc=ia,i.lhc=!1,n(a)&&i.name(a),i.cj=n(b)?b:-1,i.dj=n(c)?c:-1,i.Xj=n(d)?d:-1,i.OZ=n(e)?e:-1,n(f)&&i.style(f),i.Nz=[],h=0;h<i.OZ;h++)i.Nz.push(new Bb(h+1));i.ZX=ia,i.LAb={},i.Bec=[],i.Ts=[],i.nNb=[],i.mhc=[],i.oNb=[],i.pNb=[],i.qNb=!0}return a.prototype.no=function(){var a=this;a.Nz=[],a.mNb=[],a.Ts=[],a.nNb=[],a.mhc=[],a.LAb={},a.Bec=[],a.kj=ia,a.tc=ia,a.xr&&(a.xr.no(),a.xr=ia),a.Nm()},a.prototype.Nm=function(){this.oNb=[],this.pNb=[]},a.prototype.range=function(){var a=this;return d.kf(a.cj,a.dj,a.Xj,a.OZ)},a.prototype.dataRange=function(){var a=this,b=a.MZ?a.cj+1:a.cj,c=a.MZ?a.Xj-1:a.Xj;return a.NZ&&c--,d.kf(b,a.dj,c,a.OZ)},a.prototype.headerIndex=function(){return this.MZ?this.cj:-1},a.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},a.prototype.showHeader=function(a){var b,c=this;return 0===arguments.length?c.MZ:(c.MZ!==a&&(b=c.kj,b&&b.suspendPaint(),c.qVa(a),b&&b.resumePaint()),c)},a.prototype.qVa=function(a){var b,c,d=this,e=d.kj;e&&e.ITa.pVa(d,"showHeader",d.MZ),b=d.MZ=a,b?(d.cj>0&&(d.cj=d.cj-1,d.Xj+=1),d.PZ()):(c=d.cj,d.cj=d.cj+1,d.Xj-=1,d.QZ(c),d.RZ()),e&&g&&e.recalcRange(d.cj+(a?0:-1),d.dj,1,d.OZ)},a.prototype.showFooter=function(a,b){var c,d=this;if(0===arguments.length)return d.NZ;if(d.NZ!==a){c=d.kj,c&&c.suspendPaint();try{d.rVa(a,!!b&&b)}finally{c&&c.resumePaint()}}return d},a.prototype.expandBoundRows=function(a){var b=this;return 0===arguments.length?b.lhc:(b.lhc!==a&&(b.lhc=a),b)},a.prototype.rVa=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o=this,p=o.kj;if(p&&p.ITa.pVa(o,"showFooter",o.NZ),c=o.Xj,a){if((!p||o.cj+c<p.getRowCount())&&(!b||o.rNb(!0,c)))for(o.NZ=a,o.Xj+=1,d=o.Nz,e=d.length,f=o.footerIndex(),h=o.dj,i=0;i<e;i++)j=d[i],k=j&&j.footerFormula(),l=h+i,k&&(m=K(p,k,f,l),m&&(k=J(p,m,f,l),j.footerFormula(k)));o.SZ()}else o.NZ=a,n=o.cj+c-1,o.Xj-=1,o.QZ(n),o.NAb(),o.Cec(0),b&&o.rNb(!1,c);p&&g&&p.recalcRange(o.cj+o.Xj+(a?-1:0),o.dj,1,o.OZ)},a.prototype.rNb=function(a,b){var c,e=this,f=e.kj,g=e.cj+b,h=e.dj,i=e.OZ,j=h+i-1,k=O(f,e),l=k>=g,m=R(f,new d.Range(g,h,k-g+1,j-h+1)),n=m&&m.row,o=n===g;return(!o||!Q(f,e,g,k,h,j,1))&&(o&&l&&(c=a?g+1:g-1,f.moveTo(g,h,c,h,k-g+1,i,1023)),!0)},a.prototype.sNb=function(a){var b,c,d,e,f=this,g=f.Nz,h=g.length,i=f.dj,j=[],k=f.name();for(b=0;b<h;b++)c=i+b,d=f.getColumnName(b),j.push(Ib(k,d)),a||(0===b?f.j$(c,vb().Table_Total,!0):b===h-1&&(e=g[b].footerFormula(),e||(f.tNb(c)?f.i$(b,"=SUBTOTAL(109,"+k+"["+d+"])"):f.i$(b,"=SUBTOTAL(103,"+k+"["+d+"])"))));f.mNb=j},a.prototype.tNb=function(a){var b,c,d=this,e=d.kj,f=d.dataRange(),g=!0,h=f.rowCount,i=f.row;for(b=0;b<h;b++)if(c=e.getValue(i+b,a),!s(c)&&typeof c!==sb){g=!1;break}return g},a.prototype.uNb=function(){return this.mNb&&this.mNb.length>0},a.prototype.vNb=function(a,b,c){var d=this,e=this.kj;d.uNb()&&(e&&e.ITa.pVa(d,Ya,d.wNb()),b>=0&&(c?d.mNb.splice(a,b,c):d.mNb.splice(a,b)))},a.prototype.wNb=function(){var a=this,b=a.mNb,c=[];return b.forEach(function(a){a&&c.push(a.clone())}),c},a.prototype.xNb=function(a,b,c){var d=this,e=n(c)?Ib(d.name(),c):ia;d.uNb()&&d.vNb(a,b,e)},a.prototype.useFooterDropDownList=function(a){var b=this,c=b.kj;return 0===arguments.length?b.kNb:(c&&(c.suspendPaint(),b.kNb!==a&&(c.ITa.pVa(b,"useFooterDropDownList",b.kNb),b.kNb=a,b.kNb&&!b.uNb()&&(b.sNb(),b.e$())),c.resumePaint()),b)},a.prototype.showResizeHandle=function(a){var b=this,c=b.kj;return 0===arguments.length?b.lNb:(c&&(c.suspendPaint(),b.lNb!==a&&(c.ITa.pVa(b,"showResizeHandle",b.lNb),b.lNb=a),c.resumePaint()),b)},a.prototype.rowFilter=function(){var a=this;return!a.xr&&b.MAb&&(a.xr=new b.MAb(a),a.xr.EZ(a.dataRange())),a.xr},a.prototype.bindColumns=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=[];if(a)for(b=a.length,l.autoGenerateColumns||(b=ka(l.OZ,a.length)),c=0;c<b;c++)d=l.Nz[c],d||(d=new Bb(l.TZ()),l.Nz[c]=d),e=a[c],f=e.id(),g=e.name(),h=e.dataField(),i=e.value(),j=_(l,g,c),d.id(f),d.name(j),d.dataField(h),d.value(i),d.cellType(e.cellType()),d.formatter(e.formatter()),k={name:j,value:i,dataField:h},h&&m.push(k),l.xNb(c,1,j);l.yNb=m,l.wq&&(l.wq.qia=m)},a.prototype.bindingPath=function(a){var b=this;return 0===arguments.length?b.UZ:(b.UZ=a,b.JZ(),b)},a.prototype.bind=function(a,b,c){var d=this,e=c;return s(a)||d.bindColumns(a),s(c)&&(e=d.LZ()),b&&(d.UZ=b,e=i.LL(e,b)),i.qL&&e&&d.zNb(e),d},a.prototype.getColumnName=function(a){var b,c,d=this.Nz;return d&&0<=a&&a<d.length&&(b=d[a])?(c=b.name(),c!==ia&&(c=o(c)),c):ia},a.prototype.setColumnName=function(a,b){var c,d,e,f,g=this;return g.VZ(b)?g:(c=g.Nz,c&&0<=a&&a<c.length&&(d=c[a],d||(d=g.Nz[a]=new Bb(g.TZ())),e=d.name(),f=g.kj,e!==b&&f&&(f.ITa.sVa(d,"name",e),d.name(b)),g.MZ&&f&&f.setText(g.headerIndex(),g.dj+a,b),g.WZ(e,d.name(),a)),g)},a.prototype.WZ=function(a,b,c){var d,e=this,f=e.Nz,g=f[c];e.xNb(c,1,g.name()),d=this.ZX,d&&d.onColumnNameChanged(a,b)},a.prototype.setColumnDataField=function(a,b){var c,d,e,f=this,g=f.Nz;return g&&0<=a&&a<g.length&&(c=g[a],c||(c=f.Nz[a]=new Bb(f.TZ())),d=f.kj,e=c.dataField(),d&&b!==e&&d.ITa.sVa(c,"dataField",e),c.dataField(b)),f},a.prototype.getColumnDataField=function(a){var b,c,d=this.Nz;return d&&0<=a&&a<d.length&&(b=d[a])?(c=b.dataField(),c!==ia&&(c=o(c)),c):ia},a.prototype.getColumnFormula=function(a){var b,c,d,e,f=this.Nz,g=this.kj;return f&&g&&0<=a&&a<f.length&&(b=f[a])?(c=this.footerIndex(),d=this.dj+a,e=b.footerFormula(),e&&K(g,e,c,d,!1)):ia},a.prototype.setColumnFormula=function(a,b){return this.i$(a,b),this},a.prototype.setColumnDataFormula=function(a,b){var c,d,e,f,h,i,j,k,l,m;if(g){if(c=this,d=c.Nz,d&&0<=a&&a<d.length&&(e=d[a])){for(f=c.kj,D(f),h=a+c.dj,i=c.cj,j=c.Xj,c.showHeader()&&(i++,j--),c.showFooter()&&j--,k=J(f,b,i,h,!0),l=e.dataAreaFormula(),f&&k!==l&&f.ITa.sVa(e,"dataAreaFormula",l),e.ANb(b),e.dataAreaFormula(k),m=i;m<i+j;m++)y(f,m,h,b,k);E(f,!1)}return c}},a.prototype.getColumnValue=function(a){var b,c,d=this,e=d.Nz;return e&&0<=a&&a<e.length&&(b=e[a])?d.NZ&&b.footerFormula()&&(c=d.kj)?c.getValue(d.footerIndex(),d.dj+a):b.footerValue():ia},a.prototype.setColumnValue=function(a,b){var c,d,e=this,f=e.Nz,g=e.kj;return f&&0<=a&&a<f.length&&(c=f[a],c&&(d=c.footerValue(),g&&b!==d&&g.ITa.sVa(c,"footerValue",d),c.footerValue(b)),e.NZ&&g&&z(g,e.footerIndex(),e.dj+a,b)),e},a.prototype.filterButtonVisible=function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.rowFilter();if(!(a<0||a>=g.OZ))switch(c=arguments,c.length){case 0:return i&&i.filterButtonVisible();case 1:if(d=c[0],e=typeof d,"number"===e)return i&&i.filterButtonVisible(d);if("boolean"===e&&i){for(A(h),f=0;f<g.OZ;f++)i.filterButtonVisible(f,d);B(h)}return g;case 2:return i&&i.filterButtonVisible(a,b),g}},a.prototype.allowAutoExpand=function(a){var b=this,c=b.kj;return 0===arguments.length?b.qNb:(b.qNb!==a&&(c.ITa.pVa(b,"allowAutoExpand",b.qNb),b.qNb=a),b)},a.prototype.Aq=function(){return!!this.ZX},a.prototype.Yv=function(a){var b=this,c=b.tc;b.BNb(a),b.kj&&b.kj.ITa&&b.kj.ITa.CNb(b,c)},a.prototype.BNb=function(a){var b,c=this;c.tc=a,c.kj=a&&a.kj,b=c.xr,a&&b&&b.kj!==a.kj&&b.table(c)},a.prototype.Fu=function(a){var b,c,d,e,f,g,h,i,j,k=this,l=k.autoGenerateColumns(),m=k.xr&&k.xr.qZ;if(k.RZ(),b=k.kj,b&&(c=k.dataRange(),l?b.cg(c.row,c.col,F(c),G(c),3,17,!1,!0):q(k.Nz,function(a,d){var e=d.dataField();e&&b.cg(c.row,c.col+a,F(c),1,3,17,!1,!0)})),l&&(d=k.range(),k.$b(d.row,d.col,F(d),G(d)),k.SZ(d.col,G(d),!0)),a.qia=k.yNb,k.wq=a,a)if(b&&b.ITa.pVa(k,ob,{row:k.cj,col:k.dj,rowCount:k.Xj,colCount:k.OZ}),e=a.getRowCount(),f=a.getColumnCount(),k.MZ&&e++,k.NZ&&e++,k.Xj=e,l){for(k.OZ=f,k.Nz=[],g=a.rL(),h=0;h<k.OZ;h++)i=new Bb(h+1),k.Nz[h]=i,g&&(i.name(g[h]),i.dataField(g[h]));k.kNb&&(k.mNb=[],k.JNb(k.dj))}else j=[],k.Nz.forEach(function(a){var b=a.dataField();b&&j.push(b)}),a.Nka(j);k.xr&&(k.xr.EZ(k.dataRange()),k.xr.qZ=m)},a.prototype.XZ=function(a){var b,c,d,e,f,g=this,h=g.wq;if(h&&(b=h.rL()))for(c=g.Nz[a-g.startColumn()],d=c&&c.dataField(),e=0,f=b.length;e<f;e++)if(b[e]===d)return e;return-1},a.prototype.ge=function(a,b){var c,d=!1,e=ja,f=this,g=f.wq,h=a-f.dataRange().row;return g&&h<g.getRowCount()&&(c=f.XZ(b),c>=0&&(d=!0,e=g.getValue(h,c).value)),{gt:d,Qb:e}},a.prototype.yq=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=k.wq,m=T(k,a),n=k.xr,o=!1;return l&&(e=k.XZ(b),e>=0&&(d&&n&&n.isRowFilteredOut(a)||(g=l.getValue(m,e),f=g.value,h=k.kj,i=h&&h.ITa,i&&g.hasBinding&&f!==c&&(j=V(!0),k.DNb(a,m,j),i.ENb(k,a,ia,j,xb.dirty),i.Cp(a,b,{Ep:f})),l.setValue(m,e,c,i&&i.zTa)),o=!0)),o},a.prototype.Gq=function(a,b,c){var e=new d.Style;return this.Yo(a,b,e,c),e},a.prototype.D3=function(a){var b,c=this.tc.$m,d=c[a];return d!==ja?d:(b=this.kj,d=c[a]=b.getRowHeight(a))},a.prototype.C3=function(a){var b=this.kj;return b.getColumnWidth(a)},a.prototype.Yo=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=this,W=V.style();if(W){if(f=V.kj,g=V.MZ,h=V.NZ,i=V.Nz,j=V.highlightLastColumn(),k=V.highlightFirstColumn(),l=V.headerIndex(),m=V.footerIndex(),n=g?a===V.cj+1:a===V.cj,o=h?a===V.cj+V.Xj-2:a===V.cj+V.Xj-1,p=b===V.dj,q=b===V.dj+V.OZ-1,r=g?a===l:a===V.cj,s=h?a===m:a===V.cj+V.Xj-1,t=W[Ba](),u=W[Ca](),v=new d.Style,l===a)w=W[Ia](),q&&j&&w&&w.Yo(v,!0,!0,!0,!0),x=W[Ha](),p&&k&&x&&x.Yo(v,!0,!0,!0,!0),y=W[ya](),y&&y.Yo(v,!0,p,!0,q),q&&j&&t&&t.Yo(v,!0,!0,!1,!0),p&&k&&u&&u.Yo(v,!0,!0,!1,!0);else if(m===a)z=W[Ka](),q&&j&&z&&z.Yo(v,!0,!0,!0,!0),A=W[Ja](),p&&k&&A&&A.Yo(v,!0,!0,!0,!0),B=W[za](),B&&B.Yo(v,!0,p,!0,q),q&&j&&t&&t.Yo(v,!1,!0,!0,!0),p&&k&&u&&u.Yo(v,!1,!0,!0,!0);else{if(q&&j&&t&&t.Yo(v,r,!0,s,!0),p&&k&&u&&u.Yo(v,r,!0,s,!0),C=g?a-V.cj-1:a-V.cj,D=b-V.dj,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0,K=void 0,L=!e||"cellType"!==e&&"formatter"!==e,V.bandRows()&&L&&(E=W[La](),F=E+W[Ma](),F>0)){if(G=V.oNb[a],void 0===G){if(d.mn.nn&&d.mn.sn){for(M=d.mn.sn,N=V.dataRange().row;M[N]===-1;)N++;if(N>a)return;C=M[a]-M[N]}else if(f){for(O=0,N=V.dataRange().row;N<a;N++)V.D3(N)>0&&O++;C=O}G=V.oNb[a]=C%F}H=W[Da](),I=W[Ea](),G<E&&H?(J=0===G,K=o||G===E-1,H.Yo(v,J,p,K,q)):G>=E&&I&&(J=G===E,K=o||G===F-1,I.Yo(v,J,p,K,q))}if(V.bandColumns()&&L&&(E=W[Na](),F=E+W[Oa](),F>0)){if(G=V.pNb[b],void 0===G){if(P=0,f)for(Q=V.dj;Q<b;Q++)V.C3(Q)>0&&P++;G=V.pNb[b]=P%F}H=W[Fa](),I=W[Ga](),G<E&&H?(J=0===G,K=q||G===E-1,H.Yo(v,n,J,o,K)):G>=E&&I&&(J=G===E,K=q||G===F-1,I.Yo(v,n,J,o,K))}i&&i.length>0&&(R=i[D],R&&(S=R.cellType(),T=R.formatter(),S&&(v.cellType=S),T&&(v.formatter=T)))}U=W[Aa](),U&&U.Yo(v,r,p,s,q),V.Oka(c,v)}},a.prototype.jNb=function(a,b,c){var d,e,f,g=this,h=g.NZ,i=g.kNb,j=g.footerIndex(),k=j===a;k&&h&&g.uNb()&&(d=g.mNb[b-g.dj],d&&i&&(e=c.cellButtons,f=c.dropDowns,s(e)&&(e=[]),c.cellButtons=e.concat(d.cellButtons),s(f)&&(f=[]),c.dropDowns=f.concat(d.dropDowns)))},a.prototype.Oka=function(a,b){var c=a,d=20,e,f,g,h;s(c.backColor)&&(c.backColor=b.backColor),ha(c.foreColor)&&(c.foreColor=b.foreColor),s(c.themeFont)&&s(c.font)?(c.themeFont=b.themeFont,c.font=b.font):!s(c.themeFont)&&s(c.font)&&(c.font=b.font),s(c.borderLeft)&&(e=b.borderLeft,c.borderLeft=e&&e.Uo()||e,c.borderLeft&&(c.borderLeft.level=d)),s(c.borderTop)&&(f=b.borderTop,c.borderTop=f&&f.Uo()||f,c.borderTop&&(c.borderTop.level=d)),s(c.borderRight)&&(g=b.borderRight,c.borderRight=g&&g.Uo()||g,c.borderRight&&(c.borderRight.level=d)),s(c.borderBottom)&&(h=b.borderBottom,c.borderBottom=h&&h.Uo()||h,c.borderBottom&&(c.borderBottom.level=d)),s(c.textDecoration)&&(c.textDecoration=b.textDecoration),s(c.cellType)&&(c.cellType=b.cellType),s(c.formatter)&&(c.formatter=b.formatter)},a.prototype.YZ=function(a,b){var c,d,e,f,g,h=this;if((a!==h.cj||b!==h.dj)&&(c=h.kj)){if((a<0||c.getRowCount()<a+h.Xj||b<0||c.getColumnCount()<b+h.OZ)&&x(vb().Exp_TableMoveOutOfRange),d=h.tc,e=void 0,f=void 0,d)for(e=d.l$,f=0,g=e.length;f<g;f++)if(e[f]===h){e.splice(f,1),h.ZZ();break}c.moveTo(h.cj,h.dj,a,b,h.Xj,h.OZ,3),e&&f<=g&&(h.$Z(a,b),e.splice(f,0,h),h._Z()),this.Cec(1)}},a.prototype.$Z=function(a,b){var c=this,d=c.kj;d&&d.ITa.pVa(c,ob,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),c.cj=a,c.dj=b,c.a$(),c.Nm()},a.prototype.ZZ=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,t=this,u=t.kj;if(u&&g){for(d=t.Nz,e=t.footerIndex(),f=t.range(),h=t.dataRange(),i=h.row,j=F(h),s(a)&&(a=0,b=d.length);a<b;a++)if(k=d[a],l=f.col+a,k){for(k.footerFormula()&&e>=0&&(y(u,e,l,ia),z(u,e,l,ia)),m=k.ANb(),n=da(m),o=void 0,p=void 0,q=0;q<j;q++)p=i+q,o=u.getFormula(p,l),s(o)||(s(t.FNb)&&(t.FNb=[]),t.FNb.push({row:p,col:l,formula:o})),s(o)||!s(n)&&K(u,J(u,n,t.cj,l),p,l)===o||(s(t.GNb)&&(t.GNb=[]),r=ea(t.GNb,l),s(r)?(r={},r.col=l,r.rowIndexes=[],r.rowIndexes.push(p),t.GNb.push(r)):r.rowIndexes.push(p));if(k.ANb(ja),k.dataAreaFormula())for(q=0;q<j;q++)p=i+q,y(u,p,l,ia),z(u,p,l,ia)}c===!0&&(t.FNb=[])}},a.prototype.HNb=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.kj,l=j.FNb;if(l){for(f=0;f<l.length;f++)e=l[f],d=!0,e&&(g=e.row,h=e.col,i=e.formula,g>=a&&(c===!0&&(g+=b),c===!1&&(g<a+b?d=!1:g-=b)),d&&y(k,g,h,i));j.FNb=[]}j.Gj(a,b,!0,c)},a.prototype.INb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,z=this,A=z.kj,B=z.FNb;if(B){for(f=0;f<B.length;f++)e=B[f],d=!0,e&&(g=e.row,h=e.col,i=e.formula,h>=a&&(c===!0&&(h+=b),c===!1&&(h<a+b?d=!1:h-=b)),d&&y(A,g,h,i));for(j=z.GNb||[],k=void 0,f=0;f<j.length;f++)k=j[f],k&&(l=k.col,l>=a&&(c===!0&&(k.col+=b),c===!1&&l>=a+b&&(k.col-=b)));for(z.Gj(a,b,!1,c),m=z.Nz,n=m.length,o=z.dataRange(),p=o.row,q=o.col,r=o.rowCount,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,f=0;f<n;f++)if(t=m[f],w=q+f,t&&(u=t.dataAreaFormula())){for(s=p,x=0;x<j.length;x++)if(k=j[x],k&&k.col===w){for(;k.rowIndexes.indexOf(s)>-1&&s<p+r;)s++;break}s<p+r&&(v=A.getFormula(s,w),v&&t.dataAreaFormula(J(A,v,p,w)))}z.FNb=[],z.GNb=[]}},a.prototype.Gj=function(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.kj,n=l.Nz,o=l.footerIndex(),p=l.dataRange(),q=p.row,r=p.col,s=p.rowCount,t=p.colCount,u=m.Bj(),v=m.Wu;if(v&&u&&(f=v.ih(),f&&(e||(f.Dj(u,q,r,s,t),f.Gj(u.xf,a,b,c,d,!0)),l.NZ)))for(e||(f.Dj(u,o,r,1,t),f.Gj(u.xf,a,b,c,d,!1)),k=0;k<t;k++)g=n[k],g&&(h=g.footerFormula(),j=r+k,h&&(i=m.getFormula(o,j),i&&(m&&m.ITa.sVa(g,"footerFormula",h),g.footerFormula(J(m,i,o,j)))))},a.prototype._Z=function(){var a,b,c,d=this,e=d.kj;e&&g&&(a=d.footerIndex(),b=d.range(),c=d.dataRange(),q(d.Nz,function(d,f){var g,h,i,j=b.col+d,k=f.footerFormula(),l=f.dataAreaFormula();if(k&&a>=0&&y(e,a,j,ia,k),l)for(g=0,h=F(c);g<h;g++)i=c.row+g,y(e,i,j,ia,l)}))},a.prototype.b$=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,y,z,A,B,C,D,E,H,I=this,J=I.dataRange();if(!a.equals(I.range())){if(b=a.row,c=a.col,e=F(a),f=G(a),g=I.MZ,h=I.NZ,i=I.kNb,j=0,k=1,g&&(j+=1),h&&(j+=1),l=I.kj,l&&((e<j||f<k||b+e>l.getRowCount()||c+f>l.getColumnCount())&&x(vb().Exp_TableResizeOutOfRange),b===I.cj&&a.intersect(I.cj,I.dj,I.Xj,I.OZ)||x(vb().Exp_TableResizeInvalidRange),l.ITa.pVa(I,ob,{row:I.cj,col:I.dj,rowCount:I.Xj,colCount:I.OZ}),l.ITa.pVa(I,pb,I.Nz.slice())),m=I.Nz,n=c,o=c+f-1,p=I.dj,q=I.dj+I.OZ-1,r=I.OZ,I.dj=c,I.OZ=f,n<p){for(s=0,t=n;t<p;t++)u=new Bb(I.TZ()),m.splice(s,0,u),s++;g&&I.PZ(0,p-n),h&&I.SZ(0,p-n)}else n<=q&&(I.ZZ(p,n),m.splice(0,n-p));if(o>q){for(t=q+1;t<=o;t++)u=new Bb(I.TZ()),m.push(u);g&&I.PZ(r,o-q),h&&I.SZ(r,o-q),i&&I.JNb(r)}else o>=p&&(I.ZZ(o,q),m.splice(m.length-(q-o),q-o));e!==I.Xj&&(v=I.wq,w=I.dataRange(),y=w.row,z=F(w),v?e>I.Xj?(A=y+z-1,B=e-I.Xj,l&&(C=A+B+1,D=R(l,new d.Range(C,n,l.getRowCount()-C,o)),D&&D.row<C||I.eMb(A,B,!0,!1))):l&&(E=I.Xj-e,I.STa(y+z-E,E)):(H=void 0,h&&(I.SZ(),H=I.footerIndex()),I.Xj=e,I.LNb(),h&&(I.e$(),I.QZ(H)))),I.a$(),I.f$(J,I.dataRange()),I.NAb(),I.Cec(0)}},a.prototype.f$=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.ZX;n&&(c=a.col,d=F(a),e=G(a),f=b.col,g=F(b),h=G(b),i=a.row+d,j=c+e,k=b.row+g,l=f+h,k<i&&n.onRowsRemoved(g,i-k),k>i&&n.onRowsAdded(d,k-i),f>c&&n.onColumnsRemoved(0,f-c),l<j&&n.onColumnsRemoved(h,j-l),f<c&&n.onColumnsAdded(0,c-f),l>j&&n.onColumnsAdded(c+e-f,l-j))},a.prototype.a$=function(){var a=this,b=a.xr;b&&(b.EZ(a.dataRange()),b.reFilter())},a.prototype.RZ=function(){var a=this.xr;a&&(a.unfilter(),a.reset())},a.prototype.VZ=function(a,b){var c,d;for(a!==ia&&(a=o(a)),c=0;c<this.OZ;c++)if(c!==b&&(d=this.getColumnName(c),a===d))return!0;return!1},a.prototype.g$=function(a){var b,c,d,e=this,f=e.Nz;return e.MZ&&f?(b=a-e.dj,0<=b&&b<f.length&&(c=f[b])?(d=c.name(),s(d)||(d=o(d)),d):ia):ia},a.prototype.h$=function(a,b){var c,d,e,f,g,h=this,i=h.Nz;h.MZ&&i&&(c=i.length,d=a-h.dj,0<=d&&d<c&&(e=i[d],e&&(f=e.name(),g=h.kj,g&&b!==f&&g.ITa.sVa(e,"name",f),e.name(b),h.WZ(f,e.name(),d))))},a.prototype.i$=function(a,b,c){var d,e,f=this,h=f.Nz,i=f.footerIndex(),j=f.dj+a,k=f.kj;g&&0<=a&&a<h.length&&(d=h[a],b&&!c&&k&&(c=J(k,b,i,j),f.NZ&&y(k,i,j,b,c)),d&&(e=d.footerFormula(),k&&c!==e&&k.ITa.sVa(d,"footerFormula",e),d.footerFormula(c)))},a.prototype.j$=function(a,b,c){var d,e,f,g,h=this,i=h.Nz;(c||h.NZ)&&i&&(d=a-h.dj,0<=d&&d<i.length&&(e=i[d],e&&(f=e.footerValue(),b!==f&&(g=h.kj,g&&(g.ITa.sVa(e,"footerValue",f),g.ITa.Cp(h.cj+h.Xj-1,a,{Ep:e.footerValue()}))),e.footerValue(b))))},a.prototype.TZ=function(){var a,b,c=this.Nz,d=c&&c.length,e=[];for(b=0;b<d;b++)a=c[b],a&&a.k$()&&e.push(a.id());if(e.sort(function(a,b){return a-b}),d=e.length,d>0){for(b=0;b<d;b++)if(e[b]!==b+1)return b+1;return d+1}return 1},a.prototype.dga=function(a,b){var c,d,e,f;if(a&&!this.VZ(a,b))return a;if(d=Qa,e=0,a)d=a,e=1;else if(b>0&&(a=this.Nz[b-1].name(),f=/[0-9]+$/.exec(a))){if(d=a.substr(0,f.index),e=parseInt(a.substr(f.index),10),c=d+(e+1),!this.VZ(c))return c;d=a,e=1}for(;;)if(e++,c=d+e,!this.VZ(c))return c},a.prototype.PZ=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o=this,q=o.Nz,r=o.kj;if(o.MZ&&q&&r)for(d=q.length,e=o.headerIndex(),f=o.dj,s(a)&&(a=0),s(b)&&(b=d),i=ka(d,a+b),k=a;k<i;k++)h=q[k],h&&(l=o.tc.l$,m=p(o,l),m>-1&&l.splice(m,1),j=ga(r.getValue(e,f+k)),m>-1&&l.splice(m,0,o),y(r,e,f+k,ia),j&&(c?(o.KNb=c,r.setText(e,f+k,h.name()),delete o.KNb):(g&&r.zq(e,f+k),n=o.dga(j,k),n===j?(r.ITa.sVa(h,"name",h.name()),h.name(j)):r.setText(e,f+k,n))))},a.prototype.JNb=function(a){var b,c,d=this.Nz;for(b=a;b<d.length;b++)c=Ib(this.name(),d[b].name()),this.mNb.push(c)},a.prototype.SZ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.Nz,p=n.kj;if(n.NZ&&o&&p)for(n.useFooterDropDownList()&&!n.uNb()&&n.sNb(),d=o.length,e=n.footerIndex(),f=n.dj,s(a)&&(a=0),s(b)&&(b=d),s(c)&&(c=n.nhc),h=ka(d,a+b),k=a;k<h;k++)g=o[k],g&&(j=p.getValue(e,f+k),s(j)||c?(n.KNb=c,z(p,e,f+k,g.footerValue()),delete n.KNb):(l=g.footerValue(),j!==l&&p.ITa.sVa(g,"footerValue",l),g.footerValue(j)),i=p.Ima&&p.Ima(e,f+k),i&&!c?(m=g.dataAreaFormula(),i!==m&&p.ITa.sVa(g,"dataAreaFormula",m),g.footerFormula(i)):n.S3||(n.KNb=c,y(p,e,f+k,ia,g.footerFormula()),delete n.KNb))},a.prototype.m$=function(a,b){var c,d,e,f,g,h,i=this,j=i.Nz;if(i.MZ&&j)for(c=j.length,s(a)&&(a=0),s(b)&&(b=c),e=ka(c,a+b),f=a;f<e;f++)d=j[f],d&&(g=d.name(),h=i.kj,h&&g!==ia&&h.ITa.sVa(d,"name",g),d.name(ia),i.WZ(g,d.name(),f))},a.prototype.n$=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.dataRange();if(k.containsRange(a)){for(b=a.row,c=a.col,d=F(a),e=G(a),f=[],g=0;g<d;g++)for(h=0;h<e;h++)j.yq(b+g,c+h,ia,!0),f.push({columnName:j.getColumnName(c+h-k.col),row:b+g-k.row,data:""});i=j.ZX,i&&i.onDataChanged(f)}},a.prototype.o$=function(a,b){var c,d,e,f,g,h,i=this,j=i.Nz;if(i.NZ&&j)for(s(a)&&(a=0),s(b)&&(b=j.length),d=ka(j.length,a+b),e=a;e<d;e++)c=j[e],c&&(f=i.kj,g=c.footerFormula(),f&&ia!==g&&f.ITa.sVa(c,"footerFormula",g),c.footerFormula(ia),h=c.footerValue(),f&&ia!==h&&f.ITa.sVa(c,"footerValue",h),c.footerValue(ia))},a.prototype.e$=function(){var a,b,c,d,e,f,g,h=this,i=h.Nz;if(h.NZ&&i&&(a=h.kj))for(b=i.length,d=h.dj,f=h.footerIndex(),g=0;g<b;g++)c=i[g],c&&(e=d+g,z(a,f,e,c.footerValue()),y(a,f,e,ia,c.footerFormula()))},a.prototype.QZ=function(a){var b,c,d,e,f=this,g=f.kj;if(g&&!(a<0||g.getRowCount()<=a))for(b=f.dj,c=f.OZ,e=0;e<c;e++)d=b+e,y(g,a,d,ia),z(g,a,d,ia)},a.prototype.rI=function(a,b,c,d,e){var f,g,h,i,j=this,k=!1,l=c?1:0;return a>=j.cj+j.Xj+l?k:(f=j.kj,f&&(g=f.ITa,g.pVa(j,ob,{row:j.cj,col:j.dj,rowCount:j.Xj,colCount:j.OZ})),j.ohc(a,b,!1),h=j.cj,i=j.cj+j.Xj-1+l,a<=h&&!e?j.cj+=b:a<=i&&(d||(k=j.c$(a,b)),j.Xj+=b),k)},a.prototype.KZ=function(a,b,c){var d,e,f,g,h=this,i=h.cj+h.Xj-1;!c&&a>=h.cj&&a<=i&&h.LNb(a,b),c||(h.Gj(a,b,!0,!0,!0),h.MNb()),d=h.ZX,e=h.dataRange(),f=e.row,g=h.endRow(),a>=f&&a<=g&&d&&d.onRowsAdded(a-f,b),h.xr&&h.xr.rI(a,b)},a.prototype.c$=function(a,b){var c,d,e,f=this,g=f.wq;return!!g&&(c=this.kj,d=c&&c.ITa.zTa,e=void 0,d&&(e=d.uVa,e||(e=[])),g.uL(T(f,a),b,e),!0)},a.prototype.LNb=function(a,b){if(g){var c=this,d=c.kj,e=c.dataRange();s(a)&&(a=e.row),s(b)&&(b=e.rowCount),D(d),q(c.Nz,function(e,f){var g,h,i=f.dataAreaFormula();if(i)for(g=e+c.dj,h=a;h<a+b;h++)y(d,h,g,ia,i)}),E(d,!1)}},a.prototype.MNb=function(){if(g){var a=this,b=a.kj,c=b.Bj(),d=a.dataRange(),e,f;s(e)&&(e=d.row),s(f)&&(f=d.rowCount),D(b),q(a.Nz,function(b,d){var g,h,i,j,k=d.NNb();if(k&&k.isArrayFormula)for(g=k.isDynamicArray,h=b+a.dj,i=e;i<e+f;i++)s(c.Qf(i,h))&&(j={row:i,col:h,rowCount:1,colCount:1,isDynamicArray:g},c.Xf(i,h,j))}),E(b,!1)}},a.prototype.tI=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this,q=c?1:0;if(!(a>=p.dj+p.OZ+q)){if(f=p.dj,g=p.kj,g&&(g.ITa.pVa(p,ob,{row:p.cj,col:p.dj,rowCount:p.Xj,colCount:p.OZ}),g.ITa.pVa(p,pb,p.Nz.slice())),a<=p.dj&&!e)p.dj+=b;else if(a<p.dj+p.OZ+q&&(p.OZ+=b,h=p.Nz)){for(i=a-p.dj,j=0;j<b;j++)k=p.TZ(),l=i+j,m=new Bb(k),m.name(p.dga(ia,l)),h.splice(l,0,m),n=p.getColumnName(l),p.xNb(l,0,n);d&&p.PZ(i,ja,!0)}p.xr&&p.xr.tI(a,b),a>=f&&(o=p.ZX,o&&o.onColumnsAdded(a-f,b))}},a.prototype.khc=function(){var a,b,c,d,e=this,f=e.kj,g=f.Bj();g&&e.NZ&&(a=e.Nz,b=e.footerIndex(),c=e.dj,a.forEach(function(a,e){d=g.Kf(b,c+e),s(d)||a.footerFormula(d)}))},a.prototype.GR=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=this,q=!1;return a>=p.cj+p.Xj?q:(e=p.dataRange(),f=e.row,g=F(e),h=p.cj,i=p.cj+p.Xj-1,j=p.kj,k=p.wq,j&&(m=j.ITa,m.pVa(p,ob,{row:p.cj,col:p.dj,rowCount:p.Xj,colCount:p.OZ}),l=m.zTa,l&&(n=l.uVa,n||(n=[]))),p.ohc(a,b,!0),a<h?a+b<=h&&(p.cj-=b):a===h?p.MZ||(p.Xj-=ka(i-a+1,b),!c&&k&&(m&&m.ENb(p,a,b,d,xb.deleted),k.wL(T(p,a),ka(i-a+1,b),n),q=!0)):a<=i&&(p.Xj-=ka(i-a+1,b),!c&&k&&(m&&m.ENb(p,a,b,d,xb.deleted),k.wL(T(p,a),ka(i-a+1,b),n),q=!0),a===i&&p.NZ&&(j&&j.ITa.pVa(p,"showFooter",p.NZ),p.NZ=!1)),p.xr&&p.xr.GR(a,b),a>=f&&a<f+g&&(o=p.ZX,o&&o.onRowsRemoved(a-f,b)),q)},a.prototype.HR=function(a,b){var c,d,e,f,g,h=this,i=h.Nz;a>=h.dj+h.OZ||(c=h.kj,c&&(c.ITa.pVa(h,ob,{row:h.cj,col:h.dj,rowCount:h.Xj,colCount:h.OZ}),c.ITa.pVa(h,pb,h.Nz.slice())),d=h.dj,e=h.dj,f=h.dj+h.OZ-1,a<e?a+b<=e?h.dj-=b:(h.dj=a,h.OZ-=a+b-e,i&&(i.splice(0,a+b-e),h.xNb(0,a+b-e))):(h.OZ-=ka(f-a+1,b),i&&(i.splice(a-e,ka(f-a+1,b)),h.xNb(a-e,ka(f-a+1,b)))),h.xr&&h.xr.HR(a,b),a>=d&&(g=h.ZX,g&&g.onColumnsRemoved(a-d,b)))},a.prototype.$b=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=c,t=e,u=r.kj;u&&(s=u.getRowCount(),t=u.getColumnCount()),f=a<0?0:a,g=b<0?0:b,h=a<0?s:c,i=b<0?t:e,j=d.kf(f,g,h,i),k=r.headerIndex(),r.MZ&&f<=k&&k<f+h&&(l=d.kf(k,r.dj,1,r.OZ),m=j.getIntersect(l,s,t),m&&r.m$(m.col-r.dj,G(m))),n=r.dataRange(),o=j.getIntersect(n,s,t),o&&r.n$(o),p=r.footerIndex(),r.NZ&&f<=p&&p<f+h&&(q=d.kf(p,r.dj,1,r.OZ),m=j.getIntersect(q,s,t),m&&r.o$(m.col-r.dj,G(m))),r.xr&&r.xr.$b(a,b,c,e)},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,i,j,k=this,l=k.style(),m=k.rowFilter(),n="columns";for(s(a)?b=k.name():(b=a,k.KXc=b),c={name:[b,ia],row:[k.cj,-1],col:[k.dj,-1],rowCount:[k.Xj,-1],colCount:[k.OZ,-1],showHeader:[k.MZ,!0],showFooter:[k.NZ,!1],useFooterDropDownList:[k.kNb,!1],showResizeHandle:[k.lNb,!1],highlightFirstColumn:[k.highlightFirstColumn(),!1],highlightLastColumn:[k.highlightLastColumn(),!1],bandRows:[k.bandRows(),!0],expandBoundRows:[k.expandBoundRows(),!1],bandColumns:[k.bandColumns(),!1],style:[l?l.toJSON():ia,ia],autoGenerateColumns:[k.autoGenerateColumns(),!0],bindingPath:[k.bindingPath(),ja],rowFilter:[m?m.toJSON():ia,ia],reservedElement:[k.ONb,ia],allowAutoExpand:[k.qNb,!0]},c[n]=[[]],d=0;d<k.Nz.length;d++)e=k.Nz[d].toJSON(),f=e[Ta],g=e[Wa],f&&(e[Ta]=K(k.kj,f,k.footerIndex(),d+k.dj)),g&&(e[Wa]=K(k.kj,g,k.dataRange().row,d+k.dj)),c[n][0][d]=e;c[n][1]=ia,h={};for(i in c)j=c[i],j[0]!==j[1]&&(h[i]=j[0]);return r(h)?ja:h},a.prototype.fromJSON=function(a,c){var d,e,f,g,h,j,l,m,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;if(a){if(d=this,q([pa,ta,ua,va,wa,xa],function(b,c){n(a[c])&&d[c](a[c],!1)}),e=a.row,n(e)&&(d.cj=e),f=a.col,
n(f)&&(d.dj=f),g=a.rowCount,n(g)&&(d.Xj=g),h=a.colCount,n(h)&&(d.OZ=h),j=a.showHeader,n(j)&&(d.MZ=j),l=a.showFooter,n(l)&&(d.NZ=l),m=a.expandBoundRows,n(m)&&(d.lhc=m),o=a.useFooterDropDownList,n(o)&&(d.kNb=o),p=a.showResizeHandle,n(p)&&(d.lNb=p),r=a.style,r&&(s=new k.TableTheme,s.fromJSON(r,c),d.style(s)),t=a.dataSource,u=a.dataBinding,v=a.bindingPath,c?(t&&i.qL&&(d.wq=new i.qL,d.wq.bind(t)),u&&i.qL&&(d.wq=new i.qL,d.wq.fromJSON(u))):v&&(d.UZ=v,w=d.kj,x=w&&w.getDataSource&&w.getDataSource(),i.CellBindingSource&&x instanceof i.CellBindingSource&&(y=i.LL(x.getSource(),v),y&&(d.wq=new i.qL,d.wq.bind(y)))),z=a.columns){for(A=z,B=A.length,C=d.Nz=[],D=void 0,E=void 0,F=0;F<B;F++)E=A[F],D=new Bb(d.TZ()),D.fromJSON(E),G=D.name(),H=d.dga(G,F),C.push(D),H!==G&&d.setColumnName(F,H);d.Qdc()}d.kNb&&d.sNb(!0),I=a.rowFilter,I&&(J=b.MAb&&new b.MAb,J&&(J.table(d),J.fromJSON(I,c),d.xr=J,d.xr.reFilter())),K=a.reservedElement,K&&(d.ONb=K),L=a.allowAutoExpand,n(L)&&(d.qNb=L)}},a.prototype.formulaFromJSON=function(){var a,b,c,d,e,f,g=this,h=g.kj,i=h.Bj(),j=g.Nz,k=g.footerIndex(),l=g.dataRange().row,m=g.dj;for(c=0;c<j.length;c++)a=j[c],b=c+m,d=a.footerFormula(),d&&typeof d===tb&&a.footerFormula(J(h,d,k,b)),e=a.dataAreaFormula(),e&&i&&(f=i.Qf(l,b),s(f)||a.NNb({isArrayFormula:!0,isDynamicArray:f.isDynamicArray})),e&&typeof e===tb&&a.dataAreaFormula(J(h,e,l,b))},a.prototype.Qdc=function(){var a,b,c,d=this,e=d.Nz,f=e.length;for(c=0;c<f;c++)a=e[c],b=a.id(),b<1&&a.id(d.TZ())},a.prototype.startRow=function(){return this.cj},a.prototype.startColumn=function(){return this.dj},a.prototype.endRow=function(){return this.cj+this.Xj-1},a.prototype.endColumn=function(){return this.dj+this.OZ-1},a.prototype.hasHeadersRow=function(){return this.MZ},a.prototype.hasTotalsRow=function(){return this.NZ},a.prototype.tableName=function(){return this.name()},a.prototype.getColumnIndexInTable=function(a){a=a.toLowerCase().replace(/\u00A0/g," ");var b=-1,c=f.Common.u.Gb(a,"\r\n","\n");return s(a)||q(this.Nz,function(d,e){var f=(""+e.name()).toLowerCase().replace(/\u00A0/g," ");if(f===a||f===c)return b=d,!1}),b},a.prototype.source=function(){var a=this.kj;return a&&a.yj&&a.yj()},a.prototype.JZ=function(){var a,b,c,d=this,e=d.kj;e&&(a=d.bindingPath(),a&&(b=e.getDataSource&&e.getDataSource(),i.CellBindingSource&&b instanceof i.CellBindingSource&&(c=i.LL(b.getSource(),a),d.zNb(c))))},a.prototype.zNb=function(a){var b,c,d,e,f,h,j,k=this,l=k.kj;if(a){b=k.dataRange(),c=b.row,d=F(b),e=new i.qL,e.bind(a,l.ITa.zTa),f=e.getRowCount();try{A(l),k.wq=ia,f>d?k.lhc?l.addRows(c+d,f-d):(h=l.wq,h&&h.aLb&&(h.bLb=!0),k.PNb=!0,0===d?k.Nia(c,f):k.Nia(c+d-1,f-d,!0),delete k.PNb):f<d&&(k.lhc?l.deleteRows(c+f,d-f):(k.PNb=!0,k.STa(c+f,d-f),delete k.PNb)),k.Fu(e),j=g&&l.Cf(),j&&!j.IsSuspended()&&l.recalcAll()}finally{B(l)}}},a.prototype.clone=function(){var b=this,c=new a,d=na(b.toJSON());return c.Yv(b.tc),c.fromJSON(oa(d)),c},a.prototype.p$=function(a){var b=new i.qL;b.bind(a),this.wq=b},a.prototype.Az=function(a){if(a&&!a.bindingPath()){var b=a.wq;b&&this.p$(b.getSource())}},a.prototype.LZ=function(){var a=this.wq;return a?a.getSource():ia},a.prototype.q$=function(){var a=this.wq;return a?a.getRowCount():0},a.prototype.Eec=function(a,b){var c,d=this.Bec;b?d.push(a):(c=d.indexOf(a),c!==-1&&d.splice(c,1))},a.prototype.Cec=function(a){var b=this;b.Bec.forEach(function(c){c.Jec(b,a)}),2===a&&(b.Bec=[])},a.prototype.wzb=function(a,b,c){var d,e,f,g=this;g.OAb||(d=g.LAb,e=d[c],e||(e=d[c]={}),f=[a,b].join(","),e[f]=!0)},a.prototype.NAb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=o&&o.getCalcService&&o.getCalcService();if(n.OAb=!0,p){d=n.LAb,e=void 0;for(e in d)if(f=p.jh[e]){g=f.dUa(),h=d[e];for(i in h)j=i.split(","),k=+j[0],l=+j[1],m=f.Kf(k,l),m?(n.QNb(k,l)||n.RNb(m,a,b,c,!1,k,l),f.fg(k,l,m,void 0,!1,g)):delete h[i]}else delete d[e]}delete n.OAb},a.prototype.SNb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=o&&o.getCalcService();if(n.OAb=!0,p){d=n.LAb,e=void 0;for(e in d){f=p.jh[e],g=d[e];for(h in g)i=h.split(","),j=+i[0],k=+i[1],l=f.Kf(j,k),l&&a===j&&b===k&&(m=ba(l),m>-1&&(l.arguments[m]=c))}}delete n.OAb},a.prototype.QNb=function(a,b){var c,d,e=this,f=e.footerIndex(),g=!1;return f>-1&&a===f&&(c=e.dj,d=c+e.OZ,g=b>=c&&b<d),g},a.prototype.sort=function(a,b){var c=this,d=c.kj,e=c.dataRange(),f=c.rowFilter();d&&0<=a&&a<e.colCount&&(d.suspendPaint(),d.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:a+e.col,ascending:b}]),f&&(f.zZ={index:a+e.col,ascending:b}),d.resumePaint())},a.prototype.hJb=function(){return!!this.wq},a.prototype.eMb=function(a,b,c,e,f){var g,h,i,j,k,l,m,n=this,o=n.kj,p=n.cj,q=n.dj,r=n.Xj,s=n.OZ,t=p+r-1,u=c?a+1:a,v=u+b,w=n.dataRange();X(o);try{n.eJb(!1),n.TNb(),n.rI(u,b,c,!1,!0),n.NAb(),g=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,e&&!n.UNb&&(h=t+1,i=h+b,j=f-h+1,o.moveTo(h,q,i,q,j,s,g)),k=t-u+1,(!c||a!==t)&&k>0&&(o.dJb=!0,o.zFc=w,o.moveTo(u,q,v,q,k,s,g),delete o.zFc,delete o.dJb),l=o.ITa,m=n.dataRange(),l._Ua&&l._Ua(u,b,[m],!0),l.CVa&&l.CVa(u,b,[m]),n.VNb(),n.KZ(u,b,!0),n.LNb(),n.HNb(u,b,!0),n.MNb(),n.tc.Nm()}finally{n.eJb(!0),Y(o),n.Cec(0),o.recalcAll(!0)}},a.prototype.eJb=function(a){this.kj.eJb(a)},a.prototype.insertRows=function(a,b,c){if(!(s(a)||s(b)||b<=0)){var d=this;a=ca(d,a,!0),d.Nia(a,b,c)}},a.prototype.Nia=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;s(a)||s(b)||b<=0||(d=this,e=d.kj,f=d.dataRange(),g=f.row,h=f.rowCount,i=g+h,0===h&&a===g||!(a<g||a>=i)||x(vb().Exp_RowParamOutOfRange),j=d.cj,k=d.dj,l=d.Xj,m=d.OZ,n=j+l-1,o=k+m-1,p=O(e,d),q=p>n,Q(e,d,n+1,p,k,o,b)||d.eMb(a,b,c,q,p))},a.prototype.deleteRows=function(a,b){if(!(s(a)||s(b)||b<=0)){var c=this;a=ca(c,a,!0),c.STa(a,b)}},a.prototype.STa=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,y,z,A;if(!(s(a)||s(b)||b<=0||(c=this,e=c.kj,f=c.dataRange(),g=f.row,h=f.rowCount,(a<g||a>=g+h)&&x(vb().Exp_RowParamOutOfRange),i=c.cj,j=c.dj,k=c.Xj,l=c.OZ,m=i+k-1,n=j+l-1,(k<=1||a===g&&!c.MZ&&!c.NZ&&b>=h)&&x(vb().Exp_TableDeleteCountInvalid),o=O(e,c),p=o>m,Q(e,c,m+1,o,j,n,b,!0)))){X(e);try{c.eJb(!1),q=c.hJb(),r=void 0,q&&(r=V(!0),c.WNb(a,b,r)),c.TNb(),c.GR(a,b,ja,r),c.NAb(),t=ka(b,m-a+1),e.clear(a,j,t,l,3,383),u=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,a+b<=m&&!q&&e.moveTo(a+b,j,a,j,m-b-a+1,l,u),p&&(v=m+1,w=v-t,y=o-v+1,e.moveTo(v,j,w,j,y,l,u)),z=e.ITa,A=c.dataRange(),z.aVa&&z.aVa(a,b,[A],!0),c.VNb(),c.LNb(),c.HNb(a,b,!1),c.tc.Nm()}finally{c.eJb(!0),Y(e),c.Cec(0),e.recalcAll(!0)}}},a.prototype.insertColumns=function(a,b,c){if(!(s(a)||s(b)||b<=0)){var d=this;a=ca(d,a,!1),d.hMb(a,b,c)}},a.prototype.hMb=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,y,z,A,B,C,D,E,F;if(!(s(a)||s(b)||b<=0||(f=this,g=f.kj,h=f.dataRange(),i=h.row,j=h.col,k=h.rowCount,l=h.colCount,(a<j||a>=j+l)&&x(vb().Exp_ColParamOutOfRange),m=f.cj,n=f.dj,o=f.Xj,p=f.OZ,q=m+o-1,r=n+p-1,t=P(g,f),u=t>r,Q(g,f,m,q,r+1,t,b,!1,!0)))){v=c?a+1:a,w=v+b,X(g);try{f.eJb(!1),f.TNb(),y=!f.hJb(),z=r+1,A=z+b,B=t-z+1,C=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,u&&g.moveTo(m,z,m,A,o,B,C),f.tI(v,b,c,y,!0),f.XNb(v,b,!0),f.NAb(v,b,!0),c&&a===r||!y||(g.dJb=!0,D=f.NZ?1:0,g.moveTo(i,v,i,w,k+D,r-v+1,C),delete g.dJb),E=g.ITa,F=f.dataRange(),E.bVa&&E.bVa(v,b,[F],!0),E.EVa&&E.EVa(v,b,[F]),f.VNb(),f.LNb(),f.INb(v,b,!0),e.kDc(g,v,b,!0,!1),f.tc.Nm()}finally{f.eJb(!0),Y(g),f.Cec(0),g.recalcAll(!0)}}},a.prototype.deleteColumns=function(a,b){if(!(s(a)||s(b)||b<=0)){var c=this;a=ca(c,a,!1),c.TTa(a,b)}},a.prototype.TTa=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,y,z,A;if(!(s(a)||s(b)||b<=0||(c=this,f=c.kj,g=c.dataRange(),h=g.col,i=g.colCount,(a<h||a>=h+i)&&x(vb().Exp_ColParamOutOfRange),j=c.cj,k=c.dj,l=c.Xj,m=c.OZ,n=j+l-1,o=k+m-1,p=c.NZ?1:0,(m<=1||a===k&&b>=m)&&x(vb().Exp_TableDeleteCountInvalid),q=P(f,c),r=q>o,Q(f,c,j,n,o+1,q,b,!0,!0)))){X(f);try{c.eJb(!1),c.TNb(),c.HR(a,b),c.XNb(a,b,!1),c.NAb(a,b,!1),t=ka(b,o-a+1),f.clear(j,a,l,t,3,383),u=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,a+b<=o&&f.moveTo(j,a+b,j,a,l-p,o-b-a+1,u),r&&(v=o+1,w=v-t,y=q-v+1,f.moveTo(j,v,j,w,l,y,u)),z=f.ITa,A=c.dataRange(),z.cVa&&z.cVa(a,b,[A],!0),c.VNb(!0),c.LNb(),c.INb(a,b,!1),e.kDc(f,a,b,!1,!1),c.tc.Nm()}finally{c.eJb(!0),Y(f),c.Cec(0),f.recalcAll(!0)}}},a.prototype.TNb=function(){var a=this,b=a.kj,c=a.tc,d=c.l$;b&&b.ITa.tVa([a]),d.splice(d.indexOf(a),1),a.ZZ()},a.prototype.VNb=function(a){var b=this;b.PNb=!0,b.nhc=a,b.tc.Cz(b),delete b.nhc,delete b.PNb},a.prototype.XNb=function(a,b,c){var d,e,f,g,h=this,i=h.Nz,j=i.length,k=U(h,a);for(f=k;f<j;f++)g=void 0,c?f>k+b-1&&(g=f-b):f>=k&&(g=f+b),d=i[f],e=d.footerFormula(),e&&h.RNb(e,a,b,c,!0,g)},a.prototype.RNb=function(a,b,c,d,f,g,h){var i,j,k,l,m,n,o,p=this,q=p.kj;if(c>0&&a&&a.arguments)for(i=a.arguments,j=void 0,k=void 0,l=0;l<i.length;l++)j=i[l],j instanceof e.xzb&&(q&&(f?(m=g,q.ITa.YNb(this,j,m)):(n=g,o=h,q.ITa.ZNb(p,j,n,o))),j.JUa(),k=j.offsetWhenInsertRemoveColumn(b,c,d,f),i[l]=k)},a.prototype.ru=function(a){var b,c,d,e,f,g,h,i=this,j=i.wq,k=i.kj,l=i.MZ?1:0,m=i.cj+l+a,n=i.dj;if(!j||0===j.getRowCount())return ia;if(b=i.OZ,c={},d=j.ru(a))for(e in d)w(d,e)&&"function"!=typeof e&&(c[e]=d[e]);for(f=0;f<b;f++)g=i.Nz[f],h=g&&g.dataField(),g&&h&&h.length>0&&s(c[h])&&(c[h]=k.getValue(m,n+f));return c},a.prototype.WNb=function(a,b,c){var d,e,f,g,h,i=this,j=[],k=i.wq;if(k)for(f=k.getRowCount(),g=0;g<b;g++)d=a+g,h=ia,e=T(i,d),e<f&&(h=i.ru(e)),j.push({key:c,data:h});i.Ts=j},a.prototype.nKb=function(){var a=[],b=this.Ts;return b&&q(b,function(b,c){c&&!d.GC$.isFunction(c)&&a.push(c.data)}),a},a.prototype.DNb=function(a,b,c){var d,e,f,g,h,i=this;i.kj.gga>0||(d=i.nNb,e=i.wq,e&&(f=ia,g=e.getRowCount(),b<g&&(f=i.ru(b)),h={key:c,data:f},d[a]=h))},a.prototype.ohc=function(a,b,c){var d,e,f,g=this;if(!(g.kj.gga>0))if(d=g.nNb,c)e=d.splice(a,b),g.mhc.push({rowIndex:a,count:b,deletedDirtyItems:e});else for(f=0;f<b;f++)d.splice(a,0,ia)},a.prototype.ihc=function(a,b){this.nNb.splice(a,b)},a.prototype.phc=function(){var a,b,c=this,d=c.mhc,e=d.pop(),f=e.rowIndex,g=e.count,h=e.deletedDirtyItems;for(a=0;a<g;a++)b=h[a],c.nNb[f+a]=Fb({},b)},a.prototype.getDirtyRows=function(){var a,b,c,d=this,e=d.nNb,f=[];for(c=0;c<e.length;c++)a=e[c],s(a)||(b=T(d,c),f.push({row:b,originalItem:a.data,item:d.ru(b)}));return f},a.prototype.clearPendingChanges=function(){this.nNb=[]},a.prototype.footerRowDropDowns=function(a,b){var c,d,e,f,g=this,h=g.mNb[a];if(h){if(1===arguments.length)return h.dropDowns&&h.dropDowns.slice();if(c=h.dropDowns[0],b)return d=b.listOption,e=b.submitCommand,f=b.type,d&&(c.option=d),e&&(c.submitCommand=e),n(f)&&(c.type=f),g}},a.prototype.checkTableLastRow=function(a){var b=this,c=b.dataRange();return b.headerIndex()===a||c.row+c.rowCount-1!==a},a.prototype.checkTableLastCol=function(a){var b=this,c=b.dataRange();return c.col+c.colCount-1!==a},a.prototype.PIb=function(a,b,c,d,e){var f,g,h,i=this,j=i.kj;Z(j,i,c?gb:db,a,b,d,e),f=j.ITa,g=c?db:gb,h=!c&&ja,f&&f.ZVa(["tableRowsChanged",i,g,a,b,h,c])},a.prototype.QIb=function(a,b,c,d){var e,f,g,h=this,i=h.kj;$(i,h,c?ib:hb,a,b,d),e=i.ITa,f=c?hb:ib,g=!c&&ja,e&&e.ZVa(["tableColumnsChanged",h,f,a,b,g])},a}(),b.Table=yb;function Jb(a){return function(b,c){var d=this,e=d.kj;e&&b!==c&&(yb.ao(e,"tableNameChanged",{oldName:c,newName:b}),e.ITa.pVa(d,a,c))}}d.Zn(yb);function Kb(a,b,c,d,e){a.wu().execute({cmd:db,sheetName:a.name(),tableName:b.name(),row:c,count:d,isAfter:e})}function Lb(a,b,c,d,e){a.wu().execute({cmd:eb,sheetName:a.name(),tableName:b.name(),row:c,count:d,isAfter:e})}function Mb(a,b){a.wu().execute({cmd:fb,sheetName:a.name(),tableName:b.name()})}yb.prototype.name=m(pa,"",Jb(pa),H),yb.prototype.bandRows=m(va,!0,Jb(va)),yb.prototype.bandColumns=m(wa,!1,Jb(wa)),yb.prototype.highlightFirstColumn=m(ta,!1,Jb(ta)),yb.prototype.highlightLastColumn=m(ua,!1,Jb(ua)),yb.prototype.style=m("style",ja,Jb("style")),yb.prototype.autoGenerateColumns=m(xa,!0,Jb(xa)),h&&h.HideRowFilter&&(zb=h.HideRowFilter,Ab=function(a){Eb(b,a);function b(b){var c=a.call(this)||this,d=c;return d.table(b),c}return b.prototype.oZ=function(){return 0},b.prototype.pZ=function(){return this.range.colCount},b.prototype.table=function(a){var b=this;return 0===arguments.length?b.sj:(b.sj=a,void(a&&(b.kj=a.kj)))},b.prototype.unfilter=function(b,c){var d,e=this,f=e.kj;f&&f.suspendPaint(),a.prototype.unfilter.call(this,b,c),d=e.sj,d&&d.tc&&d.tc.Nm(),f&&f.resumePaint()},b.prototype.rI=function(b,c){var d=this,e=d.sj;a.prototype.rI.call(this,b,c),e&&d.BZ(e.dataRange())},b.prototype.GR=function(b,c){var d=this,e=d.sj;a.prototype.GR.call(this,b,c),e&&d.BZ(e.dataRange())},b.prototype.no=function(){this.sj=ia,this.kj=ia},b}(zb),b.MAb=Ab),Bb=function(){function a(a,b,c,d,e,f){var g=this;g.id(a),g.dataField(b),g.name(c||b||Qa+g.id()),g.formatter(d),g.cellType(e),g.value(f)}return a.prototype.k$=function(){return this.id()>0},a.prototype.toJSON=function(){var a=this,b={};return q(Za,function(c,d){var e=a[d]();s(e)||(d===qa&&e.toJSON&&"function"==typeof e.toJSON?b[d]=e.toJSON():b[d]=e)}),r(b)?ja:b},a.prototype.fromJSON=function(a){if(a){var b=this;q(Za,function(c,e){var f,g,h,i,j=a[e]!==ja?a[e]:a["_"+e];s(j)||e===qa&&(f=j.typeName,g=d.CellTypes&&d.CellTypes._o,h=g&&g[f]||g[j.type]||d.getTypeFromString(f),h&&(i=new h,i.fromJSON(j,!1),j=i)),s(j)||b[e](j,!1)})}},a}(),b.TableColumn=Bb,Bb.prototype.id=function(a){var b=m(Ra,ja,function(a){var b=this;b.name()||b.name(Qa+a)});return 0===arguments.length?b.call(this):s(a)?this:b.call(this,a)},Bb.prototype.name=m(pa,ja,function(a){if(!a){var b=this;b.name(Qa+b.id())}}),Bb.prototype.formatter=m(sa),Bb.prototype.cellType=m(qa),Bb.prototype.value=m(ra),Bb.prototype.dataField=m(Sa),Bb.prototype.footerValue=m(Xa),Bb.prototype.dataAreaFormula=m(Wa),Bb.prototype.footerFormula=m(Ta),Bb.prototype.ANb=m(Ua),Bb.prototype.NNb=m(Va),Cb=function(){function a(a){this.kj=a,this.l$=[],this.$m=[],this.an=[]}return a.prototype.no=function(){var a,b,c=this,d=c.l$,e=d.length;for(b=0;b<e;b++)a=d[b],a&&a.no();c.l$=[],c.Nm(),c.kj=ia},a.prototype.Nm=function(){var a,b,c,d,e=this;for(e.$m=[],e.an=[],a=e.l$,b=a.length,d=0;d<b;d++)c=a[d],c.Nm()},a.prototype.hNb=function(a,b){var c,d,e=this,f=e.l$,g=f.length;for(d=0;d<g;d++)c=f[d],!b&&Gb(c.oNb,a)?c.oNb=[]:s(c.oNb[a])||(c.oNb[a]=ja)},a.prototype.iNb=function(a){var b,c,d=this,e=d.l$,f=e.length;for(c=0;c<f;c++)b=e[c],Gb(b.pNb,a)?b.pNb=[]:s(b.pNb[a])||(b.pNb[a]=ja)},a.prototype.add=function(a,b,c,d,e,f,g){var h=this;return h.LA(h.kj,a,b,c,d,e,!0),h.Cz(new yb(a,b,c,d,e,f||k.TableThemes.medium2,g))},a.prototype.addFromDataSource=function(a,b,c,d,e,f){var g,h,j,k,l,m;if(d||x(vb().Exp_TableDataSourceNullError),i.qL)return g=this,h=g.kj,h.suspendPaint(),j=new i.qL,j.bind(d),k=j.getRowCount()+1,l=j.getColumnCount(),m=g.add(a,b,c,k,l,e,f),m.Fu(j),h.clearPendingChanges(),h.resumePaint(),m},a.prototype.find=function(a,b){var c,d,e,f=this.l$,g=f.length;for(d=0;d<g;d++)if(c=f[d],e=c.range(),e.row<=a&&a<e.row+F(e)&&e.col<=b&&b<e.col+G(e))return c;return ia},a.prototype.findByName=function(a){var b,c,d=this.l$,e=d.length;for(c=0;c<e;c++)if(b=d[c],b.name().toLowerCase()===a.toLowerCase())return b;return ia},a.prototype.pJb=function(a,b,c,e){var f,g,h=this.l$,i=h.length,j=d.kf(a,c,b,e),k=[];for(g=0;g<i;g++)f=h[g],j.containsRange(f.range())&&k.push(f);return k},a.prototype.s$=function(a,b,c,d){var e,f,g=this.l$,h=g.length,i=[];for(f=0;f<h;f++)e=g[f],e.range().intersect(a,b,c,d)&&i.push(e);return i},a.prototype.KHb=function(){var a=this,b=a.kj,c=a.find(b.Jl,b.Kl);if(c)return b.cm(new d.Range((-1),c.dj,(-1),c.OZ))},a.prototype.Cz=function(a,b){var c,d;if(a)return c=this,c.findByName(a.name())&&x(vb().Exp_TableHasSameNameError),d=c.kj,d.suspendPaint(),a.Yv(c),d.ITa.tVa([]),c.l$.push(a),a.PNb||a.JZ(),a.showHeader()&&a.PZ(),!b&&a.showFooter()&&a.SZ(),c.t$(a),d.resumePaint(),a},a.prototype.vV=function(a){var b,c=this,d=p(a,c.l$);return d>-1?(b=c.kj,b&&b.ITa.tVa([a]),c.l$.splice(d,1),c.u$([a],!1),a):ia},a.prototype.remove=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v=this;if(W(a)&&(a=v.findByName(a)),a&&(b=b||0,a.RZ(),a=v.vV(a))){c=a.range(),e=v.kj;try{if(A(e),f=c.row,g=c.row+F(c),h=c.col,i=c.col+G(c),j=void 0,k=void 0,l=a.showHeader(),m=a.headerIndex(),1!==(1&b))for(j=f;j<g;j++)for(k=h;k<i;k++)y(e,j,k,ia),z(e,j,k,ia);else if(a.hJb()){if(l)for(j=m,k=h;k<i;k++)e.setValue(j,k,a.getColumnName(k-c.col));for(n=a.dataRange(),o=n.row,p=o+F(n),q=void 0,r=void 0,t=void 0,j=o;j<p;j++)for(k=h;k<i;k++)r=a.Nz[U(a,k)],r&&(q=a.ru(T(a,j)),t=q[r.dataField()],s(t)||e.setValue(j,k,t))}else if(l)for(j=m,k=h;k<i;k++)e.setValue(j,k,a.getColumnName(k-c.col));if(2===(2&b))for(j=f;j<g;j++)for(k=h;k<i;k++)u=e.getStyle(j,k)||new d.Style,a.Yo(j,k,u),e.setStyle(j,k,u)}finally{B(e)}a.Cec(2)}return a},a.prototype.move=function(a,b,c){var d,e,f,g=this,h=g.kj;if(W(a)&&(a=g.findByName(a)),a&&b>=0&&c>=0&&(d=a.range(),e=g.s$(b,c,F(d),G(d)),f=e.length,0===f||1===f&&e[0]===a)){A(h);try{a.YZ(b,c)}finally{B(h)}}},a.prototype.resize=function(a,b){var c,e,f,g,h,i,j,k,l,m,n=this,o=n.kj;if(W(a)&&(a=n.findByName(a)),a&&(c=a.range(),e=a.dataRange(),f=arguments,g=b,3===f.length&&(g=d.kf(c.row,c.col,f[1],f[2])),g&&(h=F(g),i=G(g),h>=0&&i>=0&&(j=n.s$(g.row,g.col,h,i),j.length<=1)))){X(o);try{a.b$(g),a.hJb()||(k=o.conditionalFormats,l=o.uja,m=g.rowCount-c.rowCount,k&&k.XXc(c,e,m),l&&l.XXc(c,e,m))}finally{Y(o)}}},a.prototype.all=function(){var a=[];return q(this.l$,function(b,c){a.push(c)}),a},a.prototype.Xec=function(a){var b,c=a||this.l$,d=c.length;for(b=0;b<d;b++)c[b].clearPendingChanges()},a.prototype.Nec=function(a,b,c,d){var e,f,g=[],h=this.l$,i=h.length;for(e=0;e<i;e++)f=h[e],f.cj>=a&&f.dj>=b&&f.cj+f.Xj<=a+c&&f.dj+f.OZ<=b+d&&g.push(f);return g},a.prototype.Oec=function(a,b,c,d){var e=this,f=e.s$(a,b,c,d),g=e.Nec(a,b,c,d),h=[];return g.length>0?f.forEach(function(a){g.indexOf(a)===-1&&h.push(a)}):h=f,h},a.prototype.Pec=function(a,b,c){var d,e,f,g=a.length;for(e=0;e<g;e++)if(d=a[e],f=d.range(),f.row<=b&&b<f.row+F(f)&&(c<0||f.col<=c&&c<f.col+G(f)))return!0;return!1},a.prototype.LA=function(a,b,c,d,e,f,h){var i,j,k,l;return b?I(b)?c<0||e<1||c+e>a.getRowCount()?(h&&x(vb().Exp_TableInvalidRow),!1):d<0||f<1||d+f>a.getColumnCount()?(h&&x(vb().Exp_TableInvalidColumn),!1):(i=a.tables,i.rn(c,d,e,f)?(h&&x(vb().Exp_TableIntersectError),!1):i.findByName(b)?(h&&x(vb().Exp_TableHasSameNameError),!1):(j=g&&a.Ms(c,d,e,f),k=j&&j.ranges,l=!0,k&&q(j,function(a,b){if(F(b)>1||G(b)>1)return h&&x(vb().Exp_ArrayFormulaTable),l=!1,!1}),l)):(h&&x(vb().Exp_TableNameInvalid),!1):(h&&x(vb().Exp_TableEmptyNameError),!1)},a.prototype.$Hb=function(a,b,c,d){var e,f,g=[],h=this.l$;for(e=0;e<h.length;e++)f=h[e],f.cj>=a&&f.dj>=b&&f.cj+f.Xj<=a+c&&f.dj+f.OZ<=b+d&&g.push(f.name());return g},a.prototype.HZ=function(a,b,c,e){var f,g,h,i,j=this.all();if(j)for(f=d.kf(a,b,c,e),g=j.length,h=void 0,i=0;i<g;i++)if(h=j[i].range(),f.intersect(h.row,h.col,F(h),G(h))&&!f.containsRange(h))return!0;return!1},a.prototype.rn=function(a,b,c,d){var e,f,g=this.l$,h=g.length;for(f=0;f<h;f++)if(e=g[f],e.range().intersect(a,b,c,d))return!0;return!1},a.prototype._getTable=function(a,b,c,d,e){var f,g,h,i=a.tables.all(),j=i.length,k=[];for(g=0;g<j;g++)f=i[g],h=f.range(),h.row>=b&&h.col>=c&&h.row+h.rowCount<=b+d&&h.colCount+h.col<=c+e&&k.push({table:f,index:g});return k},a.prototype.zxb=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=c.tables.all(),o=n.length;if(!s(b)&&(g=d.row-b.row,h=d.col-b.col,i=this._getTable(a,b.row,b.col,b.rowCount,b.colCount),0!==i.length))for(j=0;j<o;j++)for(f=n[j],k=0;k<i.length;k++)if(l=i[k],(!e||j!==l.index)&&(m=l.table.range(),f.range().intersect(m.row+g,m.col+h,m.rowCount,m.colCount)))return c.Os(6,vb().Exp_TableIntersectError),!0;return!1},a.prototype.KZ=function(a,b){var c,d,e=this,f=e.l$;for(c=0,d=f.length;c<d;c++)f[c].KZ(a,b);e.kj.filterRowsVisibleInfo.NTa(a,b)},a.prototype.rI=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.l$,q=[];for(c=0,e=p.length;c<e;c++)f=p[c],g=f.LZ(),u(q,g)?f.rI(a,b,!0):(h=f.rI(a,b),h&&q.push(g));i=o.kj;try{for(A(i),j=void 0,k=void 0,c=0,e=p.length;c<e;c++)f=p[c],j=f.q$(),k=f.dataRange(),j>0&&j!==F(k)&&(l=j,f.showHeader()&&(l+=1),f.showFooter()&&(l+=1),m=f.range(),n=d.kf(m.row,m.col,l,G(k)),f.b$(n))}finally{B(i)}},a.prototype.tI=function(a,b){var c,d,e=this.l$,f=e.length;for(d=0;d<f;d++)c=e[d],c.tI(a,b)},a.prototype.khc=function(a){var b,c,d,e,f=this.l$,g=f.length;for(e=0;e<g;e++)b=f[e],c=b.dj,d=b.endColumn(),c<=a&&d>=a&&b.khc()},a.prototype.GR=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.l$,s=[],t=[],v=[];for(c=0,e=r.length;c<e;c++)f=r[c],g=f.LZ(),h=f.range(),i=a<=h.row&&h.row+F(h)<=a+b,i?v.push(f):(u(s,g)?f.GR(a,b,!0):(f.hJb()&&f.WNb(a,b,V(!0)),j=f.GR(a,b),j&&s.push(g)),t.push(f));q.kj.filterRowsVisibleInfo.PTa(a,b),q.kj.ITa.tVa(v),q.l$=t,q.u$(v,!0),k=q.kj;try{for(A(k),r=q.l$,l=void 0,m=void 0,c=0,e=r.length;c<e;c++)f=r[c],l=f.q$(),m=f.dataRange(),l>0&&l!==F(m)&&(n=l,f.showHeader()&&(n+=1),f.showFooter()&&(n+=1),o=f.range(),p=d.kf(o.row,o.col,n,G(m)),f.b$(p))}finally{B(k)}},a.prototype.HR=function(a,b){var c,d,e,f,g=this,h=g.l$,i=[],j=[],k=h.length;for(d=0;d<k;d++)c=h[d],e=c.range(),f=a<=e.col&&e.col+G(e)<=a+b,f?j.push(c):(c.HR(a,b),i.push(c));g.kj.ITa.tVa(j),g.l$=i,g.u$(j,!0)},a.prototype.$b=function(a,b,c,e,f){var g,h,i,j,k,l=this,m=d.kf(a,b,c,e),n=[],o=l.kj;if(1===(1&f)){for(j=[],g=l.l$,h=g.length,k=0;k<h;k++)i=g[k],m.containsRange(i.range())?n.push(i):j.push(i);for(h=j.length,k=0;k<h;k++)i=j[k],i.$b(a,b,c,e);o&&o.ITa.tVa(n),l.l$=j}if(2===(2&f))for(g=l.l$,h=g.length,k=0;k<h;k++)i=g[k],m.containsRange(i.range())&&(o&&o.ITa.pVa(i,"style",i.style()),i.style(ia));return l.u$(n,!0),n},a.prototype.u$=function(a,b){if(a&&0!==a.length){var c=this.kj;d.GC$.each(a,function(a,b){b.Aq()&&b.getSlicerData().onTableRemoved(b),b.uNb()&&(c&&c.ITa.pVa(b,Ya,b.wNb()),b.mNb=[])}),g&&Hb(this.kj,a,b)}},a.prototype.t$=function(a){a&&a.Aq()&&a.getSlicerData().onTableAdded(a)},a.prototype.v$=function(a){for(var b=1,c=this,d=a,e=c.MXc();!this.NXc(d,e);)d=a+b,b++;return d},a.prototype.MXc=function(){var a,b,c,d,e,f,g,h=[],i=this.kj.parent,j=i.sheets;for(b=0,c=j;b<c.length;b++)for(d=c[b],a=d.tables.all(),e=0,f=a;e<f.length;e++)g=f[e],h.push(g);return h},a.prototype.NXc=function(a,b){var c,d,e;for(c=0,d=b;c<d.length;c++)if(e=d[c],e.name().toLowerCase()===a.toLowerCase())return!1;return!0},a.prototype.ge=function(a,b){var c=this,d=!1,e=ia,f=c.find(a,b);return f&&(f.showHeader()&&a===f.headerIndex()?(e=f.g$(b),s(e)||(e=o(e)),d=!0):(e=f.ge(a,b),d=e.gt,e=e.Qb)),{gt:d,Qb:e}},a.prototype.yq=function(a,b,c){var d=this,e=!1,f=!0,g=d.find(a,b);return g&&g.KNb!==!0&&(g.showHeader()&&a===g.headerIndex()?g.VZ(c)?f=!1:(c=s(c)?c:o(c),g.h$(b,c)):g.showFooter()&&a===g.footerIndex()?g.j$(b,c):e=g.yq(a,b,c)),e||!f},a.prototype.Hma=function(a,b,c,d,e,f){var h=this.find(a,b);if(g&&h){if(c>1||d>1)return this.kj.Os(0,vb().Exp_ArrayFormulaTable),!1;if(h.showHeader()&&a===h.headerIndex()&&e)return!1;!h.KNb&&h.showFooter()&&a===h.footerIndex()&&(s(e)||h.j$(b,ia),h.i$(b-h.dj,e,f))}return!0},a.prototype.IZ=function(){var a,b,c,d=this.all();for(a=0,b=d.length;a<b;a++)c=d[a],c.bindingPath()&&(c.wq=ia)},a.prototype.dB=function(a,b){var c,d,e,f=[],g=this;if(g&&(c=g.all()))for(e=c.length-1;e>=0;e--)d=c[e],a.containsRange(d.range())&&(b&&(this.kj&&this.kj.ITa.tVa([d]),g.l$.splice(e,1),d.ZZ(ja,ja,b)),f.push(d));return f},a.prototype.eB=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n=this,o=[];for(g=0,h=a.length;g<h;g++)i=a[g],j=void 0,k=void 0,f?k=i:(j=i.bindingPath()?ja:i.LZ(),k=new yb,k.Yv(n),k.fromJSON(oa(na(i.toJSON()))),k.name(n.v$(k.name())),o.push(k)),l=k.range(),k.S3=!0,k.$Z(d+l.row-b,e+l.col-c),n.Cz(k,f),f?(m=k.ZX,m&&(m.kj=n.kj,m.refresh())):j&&k.p$(j),k.S3=!1;for(g=0;g<o.length;g++)o[g].formulaFromJSON()},a.prototype.R3=function(a){for(var b=0,c=a.length;b<c;b++)a[b]._Z()},a.prototype.toJSON=function(a){var b,c=this.l$,d=[];if(c)for(b=0;b<c.length;b++)a?d.push(c[b].toJSON(this.v$(c[b].name()))):d.push(c[b].toJSON());return 0===d.length?ja:d},a.prototype.fromJSON=function(a,b){var c,d,e,f;if(a)for(this.l$=[],this.Nm(),c=0,d=a.length;c<d;c++)e=a[c],f=new yb,f.Yv(this),this.l$.push(f),f.fromJSON(e,b)},a.prototype.containTableHeaderTotalRowForSheet=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this.kj;if(m&&(a=m.getSelections(),b=m.tables,c=void 0,d=void 0,e=void 0,b&&a))for(f=b.l$,g=void 0,h=void 0,i=void 0,j=void 0,k=0;k<a.length;k++)for(c=a[k],d=c.row,e=d+c.rowCount-1,l=0;l<f.length;l++)if(g=f[l],h=g.range(),i=g.headerIndex(),j=g.footerIndex(),!c.containsRange(h)&&(i>=d&&i<=e||j>=d&&j<=e))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var a,b,c,d,e,f,g,h,i,j=this.kj,k=!1;if(j&&(a=j.getSelections(),b=j.tables,c=void 0,d=void 0,b&&a)){if(a.length>1)return k;e=a[0],f=fa(j,e),g=void 0,h=void 0,i=void 0,f&&1===f.length&&(c=e.row,d=c+e.rowCount-1,g=f[0],h=g.headerIndex(),i=g.footerIndex(),(h>=c&&h<=d||i>=c&&i<=d)&&(k=!0))}return k},a.prototype.noRoomToInsertColumn=function(){var a,b,c,d,e,f,g,h,i=this.kj;return!!(i&&(a=i.getSelections(),b=i.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=c.colCount,g=b.find(d,e),h=i.getColumnCount(3),g&&g.endColumn()+f>=h)))},a.prototype.noRoomToInsertRow=function(){var a,b,c,d,e,f,g,h,i=this.kj;return!!(i&&(a=i.getSelections(),b=i.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=c.rowCount,g=b.find(d,e),h=i.getRowCount(3),g&&g.endRow()+f>=h)))},a.prototype.checkTableRow=function(){var a,b,c,d,e,f,g,h=this.kj;return!!(h&&(a=h.getSelections(),b=h.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=b.find(d,e),g=f&&f.range(),f&&g&&!f.MZ&&!f.NZ&&1===g.rowCount)))},a.prototype.checkTableCol=function(){var a,b,c,d,e,f,g,h=this.kj;return!!(h&&(a=h.getSelections(),b=h.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=b.find(d,e),g=f&&f.range(),g&&1===g.colCount)))},a.prototype.isAcrossTables=function(){var a,b,c,d,e=this.kj,f=!1;if(e&&(a=e.getSelections(),b=e.tables,b&&a)){if(a.length>1)return f;c=a[0],d=fa(e,c),d&&(f=d.length>1)}return f},a.prototype.isWholeTableCol=function(){var a,b,c,d,e,f,g,h,i,j=this.kj,k=!1;return j&&(a=j.getSelections(),b=j.tables,b&&a&&(a.length>1?k=!0:(c=a[0],d=fa(j,c),1===d.length&&(e=d[0],f=e.dj,g=e.OZ,h=c.col,i=c.colCount,k=f===h&&g===i)))),k},a.prototype.containTableHeader=function(){var a,b,c,d,e,f,g,h,i=this.kj,j=!1;if(i&&(a=i.getSelections(),b=i.tables,c=void 0,d=void 0,b&&a)){if(a.length>1)return j;e=a[0],f=fa(i,e),f&&1===f.length&&(g=f[0],h=g.headerIndex(),c=e.row,d=c+e.rowCount-1,c<=h&&d>=h&&(j=!0))}return j},a.prototype.mKb=function(){var a,b,c,d,e,f,g,h,i=this.kj,j=!1;if(i&&(a=i.getSelections(),b=i.tables,b&&a)){if(c=i.getActiveRowIndex(),d=i.getActiveColumnIndex(),a.length>1||!b.find(c,d))return j;for(e=b.l$,f=a[0],g=void 0,h=0;h<e.length;h++)g=e[h],f&&f.intersect(g.cj,g.dj,g.Xj,g.OZ)&&(j=!0)}return j},a.prototype.PMb=function(a){var b,c,d,e,f,g,h=-1,i=this,j=i.l$;if(j)for(b=j.length,c=void 0,d=void 0,e=void 0,f=void 0,g=0;g<b;g++)c=j[g].range(),a&&!c.intersect(a.row,a.col,a.rowCount,a.colCount)||(d=c.row,e=c.rowCount,f=d+e-1,h<f&&(h=f));return h},a.prototype.QMb=function(a){var b,c,d,e,f,g,h=-1,i=this,j=i.l$;if(j)for(b=j.length,c=void 0,d=void 0,e=void 0,f=void 0,g=0;g<b;g++)c=j[g].range(),a&&!c.intersect(a.row,a.col,a.rowCount,a.colCount)||(d=c.col,e=c.colCount,f=d+e-1,h<f&&(h=f));return h},a.prototype.fIb=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=this;if(!m.kj.options.isProtected&&(f=m.all(),0!==f.length))for(i=0,j=f;i<j.length;i++)g=j[i],g.qNb&&(h=g.range(),k=b&&b.equals(h),l=b&&0!==m.kj.ITa.getSpans(b,3).length,b&&(k||l)||(g.UNb=d,m.$Nb(g,h,a,c,e),delete g.UNb))},a.prototype.$Nb=function(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=z.kj,B=null,C=!1,D=b.row,E=b.col,F=b.rowCount,G=b.colCount,H=D+F-1,I=new d.Range(D,E,F,G);if(a.showFooter()){if(g=new d.Range(D+F-1,E,1,G),c.row===g.row&&c.col>=E&&c.col+c.colCount<=E+G)return;C=!0,I.rowCount--}if(f&&(h=a.showHeader()?F-1:F,f.push(new d.Range(D,E,h,G))),i=c.row,j=c.col,k=c.row+c.rowCount-1,l=c.col+c.colCount-1,m=D+F-1,n=E+G-1,o=ja,p=A.getRowCount(),q=I.contains(i-1,j)&&!I.contains(i,j),C||(q=q&&l<=n&&j>=E),r=I.contains(i,j-1)&&!I.contains(i,j)&&k<=H&&i>=b.row,s=I.contains(i,j)&&!I.contains(k,l)){if(t=ma(m,k)-D+1,u=ma(n,l)-E+1,l>n&&(v=R(A,new d.Range(D,n+1,F,l-n)),v&&l>v.col&&(u=G)),B=new d.Range(D,E,t,u),C&&(B.rowCount++,k++),k>m&&(o=R(A,new d.Range(m+1,E,B.row+B.rowCount-1,G))),o&&(w=k-o.row+1,w>0)){if(R(A,new d.Range(p-Math.abs(w),E,Math.abs(w),G)))return void A.Os(6,vb().Exp_TableAddRowNoEnoughRoom);A.moveTo(o.row,E,B.row+B.rowCount,E,p-B.row-B.rowCount,G,2047)}}else if(q&&!C){if(B=new d.Range(i,E,c.rowCount,G),x=R(A,B,c),x&&!c.containsRange(x))return}else if(r&&(B=new d.Range(D,j,b.rowCount,c.colCount),x=R(A,B,c),x&&!c.containsRange(x)))return;if(q&&!C&&aa(e)&&(a.useFooterDropDownList(!0),Mb(A,a)),B){if(b.containsRange(B))return;y=b.union(B),z._Nb(a,b,y)}},a.prototype._Nb=function(a,b,c){var d=this.kj,e=d.getParent();e&&e.commandManager().execute({cmd:bb,sheetName:d.name(),tableName:a.name(),resizeToRange:c})},a.prototype.gJb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=this.kj,t=c.col,u=c.row,v=2,w=18,x=18,y=5,z=10,A=6,B=wb.TABLE_SELECT,C=wb.TABLE_CORNER_SELECT,D=wb.TABLE_COL_SELECT,E=wb.TABLE_ROW_SELECT,F=s.getActiveRowIndex(),G=s.getActiveColumnIndex();if(c.rowViewportIndex===-1&&(d=s.getCellRect(u,t,c.rowViewportIndex,c.colViewportIndex),e=r.find(F,G),e instanceof yb&&e.showHeader()&&F>=e.cj&&F<e.cj+e.Xj&&G>=e.dj&&G<e.dj+e.OZ&&e.cj<s.lq&&e.cj+e.Xj>s.lq&&c.col<e.dj+e.OZ&&c.col>=e.dj))if(a>d.x+y&&a<d.x+d.width-x&&b<d.height-y){for(f=s.getSelections(),g=0;g<f.length;g++)if(h=f[g],!(h.col===c.col&&1===h.colCount&&h.row===e.cj&&h.rowCount===e.Xj||h.col===c.col&&1===h.colCount&&h.row===-1&&h.rowCount===s.getRowCount()))return S(e,D)}else if(a>d.x+x)return S(e,"default");if(i=s.getCellRect(u,t),r.find(u,t)instanceof yb&&c.colViewportIndex!==-1&&c.rowViewportIndex!==-1){if(j=!1,e=r.find(u,t),k=r.find(F,G),f=s.getSelections(),l=!0,1===f.length&&(m=f[0],m.row<=u&&m.row+m.rowCount>u&&m.col<=t&&m.col+m.colCount>t&&(l=!1)),e===k&&(j=!0),t===e.dj&&u===e.cj){if(l&&j&&(a<=i.x+v||b<=i.y+v))return S(e,B);if(a>i.x+v&&a<i.x+w&&b>i.y+v&&b<i.y+A)return S(e,C);if(a>i.x+w&&b>i.y+v&&b<i.y+A)return S(e,D);if(a>i.x+v&&a<i.x+w&&b>i.y+A)return S(e,E)}if(t===e.dj+e.OZ-1&&u===e.cj){if(l&&j&&(a>=i.x+s.getColumnWidth(t)-2||b<=i.y+v))return S(e,B);if(a<i.x+s.getColumnWidth(t)-2&&b>i.y+v&&b<i.y+A)return S(e,D)}if(t===e.dj&&u===e.cj+e.Xj-1){if(l&&j&&(a<=i.x+v||b>=i.y+s.getRowHeight(u)-v))return S(e,B);if(a>i.x+v&&a<i.x+w&&b<i.y+s.getRowHeight(u)-v)return S(e,E)}if(l&&j&&t>e.dj&&t<e.dj+e.OZ&&u===e.cj&&b<=i.y+v)return S(e,B);if(t>e.dj&&t<e.dj+e.OZ&&u===e.cj&&b>i.y+v&&b<i.y+A)return S(e,D);if(l&&j&&u>e.cj&&u<e.cj+e.Xj&&t===e.dj&&a<=i.x+v)return S(e,B);if(u>e.cj&&u<e.cj+e.Xj&&t===e.dj&&a>i.x+v&&a<i.x+w)return S(e,E);if(n=s.getColumnWidth(e.dj+e.OZ-1),o=s.getRowHeight(e.cj+e.Xj-1),p=i.x+n,q=i.y+o,j&&(u>e.cj&&u<e.cj+e.Xj&&t===e.dj+e.OZ-1&&a>=p-v&&a<=p||t>e.dj&&t<e.dj+e.OZ&&u===e.cj+e.Xj-1&&b>=q-v&&b<=q)){if(t===e.dj+e.OZ-1&&u===e.cj+e.Xj-1&&b>=q-z&&a>=p-z)return ia;if(l)return S(e,B)}}return ia},a.prototype.bJb=function(a,b){var c,d,e,f,g=this,h=g.kj;if(g.find(a,b)instanceof yb){for(c=g.find(a,b),d=0,c.NZ&&(d=1),e=0,c.MZ&&(e=1);a>0&&0===h.getRowHeight(a-1);)a--;if(1===e&&b===c.dj&&a===c.cj)return f=M(h,c,!0),L(f,c.dj+c.OZ-1,f);if(b===c.dj&&a===c.cj)return f=M(h,c,!0),L(f,c.dj+c.OZ-1,f);if(a>c.cj&&a<c.cj+c.Xj-d&&b===c.dj)return a===c.cj+e?(a=M(h,c,!0),
L(a,c.dj+c.OZ-1,a)):L(a-1,c.dj+c.OZ-1,a-1)}return null},a.prototype.cJb=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kj;if(r.find(a,b)instanceof yb){for(c=r.find(a,b),e=0,c.NZ&&(e=1),f=0,c.MZ&&(f=1),g=s.getRowCount()-1;a+1<s.getRowCount()&&0===s.getRowHeight(a+1);)a++;if(g!==a&&b===c.dj+c.OZ-1&&a<c.cj+c.Xj-e)return h=c.cj+c.Xj,i=c.dj,j=c.OZ,k=i+j-1,l=L(a+1,c.dj,a+1),a===h-e-1&&(c.qNb?(m=O(s,c),1===e&&Q(s,c,h,m,i,k,1,!0,!1,!0)||(n=R(s,new d.Range(h,i,m-h+1,k-i+1)),o=n&&n.row,p=o===h,h!==s.getRowCount()&&(p?Kb(s,c,a,1,!0):Lb(s,c,a,1,!0)))):l=L(a,k+1,a)),l;if(s.getRowCount()-1===a&&b===c.dj+c.OZ-1&&0===e){for(q=c.cj+f;q+1<s.getRowCount()&&0===s.getRowHeight(q);)q++;return q+1===s.getRowCount()&&0===s.getRowHeight(q)?L(c.cj,c.dj,c.cj):L(q,c.dj,q)}}return null},a.prototype.fg=function(){var a,b,c=this,d=c.l$,e=d.length;for(b=0;b<e;b++)a=d[b],a.e$()},a.prototype.Cec=function(a,b){var c,d,e,f,g,h,i=this,j=i.l$,k=j.length;for(c=0;c<k;c++)d=j[c],a?(e=d.cj,f=d.cj+d.Xj-1,e<=b&&b<=f&&d.Cec(0)):(g=d.dj,h=d.dj+d.OZ-1,g<=b&&b<=h&&d.Cec(0))},a.prototype.KFc=function(a,b,c,d,e){var f,g,h,i=this.s$(a,b,c,d),j=[];for(f=0,g=i.length;f<g;f++)h=i[f].dataRange(),e?h.rowCount+=c:h.colCount+=d,j.push(h);return j},a}(),b.TableManager=Cb,function(a){a[a.none=0]="none",a[a.keepData=1]="keepData",a[a.keepStyle=2]="keepStyle"}(Db=b.TableRemoveOptions||(b.TableRemoveOptions={})),d.GC$.extend(d.lUa.prototype,{CNb:function(a,b){var c,d=this,e=d.zTa;e&&(e.uVa||(e.uVa=[]),c=e.uVa,c.push({type:"changeTableManager",table:a,oldTableManager:b}))},pVa:function(a,b,c){var d,e=this,f=e.zTa;f&&(f.uVa||(f.uVa=[]),d=f.uVa,d.push({type:lb,table:a,name:b,value:c}))},tVa:function(a){var b,c,d=this,e=d.zTa;e&&(e.uVa||(e.uVa=[]),b=e.uVa,c=d.noa,b.push({type:jb,tableList:c.l$.slice(),changedTables:a}))},sVa:function(a,b,c){var d,e=this,f=e.zTa;f&&(f.uVa||(f.uVa=[]),d=f.uVa,d.push({type:kb,tableColumn:a,name:b,value:c}))},vVa:function(a,b,c){var d,e=this,f=a.getValue(b,c),g=f.value,h=e.zTa;h&&(h.uVa||(h.uVa=[]),d=h.uVa,d.push({type:mb,bindingManager:a,row:b,col:c,oldValue:g}))},ENb:function(a,b,c,d,e){var f,g=this,h=g.zTa;h&&(h.uVa||(h.uVa=[]),f=h.uVa,f.push({type:nb,table:a,key:d,row:b,count:c,stateType:e}))},YNb:function(a,b,c){var d,e=this,f=e.zTa;f&&(f.aOb||(f.aOb=[]),d=f.aOb,d.push({type:qb,table:a,expression:b,col:c}))},ZNb:function(a,b,c,d){var e,f=this,g=f.zTa;g&&(g.bOb||(g.bOb=[]),e=g.bOb,e.push({type:rb,table:a,expression:b,row:c,col:d}))},wVa:function(a){var b,c,d,e,f,g,h,i;if(a)for(Ob(a.rUa),b=a.length-1;b>=0;b--)switch(c=a[b],d=void 0,c.type){case jb:e=this.noa,f=c.changedTables,e.l$=c.tableList,f&&f.length>0&&f.forEach(function(a){a&&(a.e$(),a.JZ())});break;case kb:c.tableColumn[c.name](c.value);break;case lb:d=c.table,g=c.name,h=c.value,g===ob?(d.cj=h.row,d.dj=h.col,d.Xj=h.rowCount,d.OZ=h.colCount):g===pb?d.Nz=h:g===Ya?d.mNb=h:d[g](h),d.Cec(0);break;case"changeTableManager":d=c.table,i=c.oldTableManager,d.BNb(i);break;case mb:c.bindingManager.setValue(c.row,c.col,c.oldValue);break;case nb:Nb(c.table,c.row,c.count,c.key,c.stateType)}},cOb:function(a){var b,c,d,e,f,g,h;if(a){for(b=void 0,c=a.length-1;c>=0;c--)d=a[c],d.type===qb&&(b=d.table,e=d.expression,f=d.col,g=void 0,g=b.Nz[f].footerFormula(),g&&(h=ba(g),h>-1&&(g.arguments[h]=e)));b&&b.e$()}},dOb:function(a){var b,c,d,e,f;if(a)for(b=a.length-1;b>=0;b--)c=a[b],c.type===rb&&(d=c.expression,e=c.row,f=c.col,c.table.SNb(e,f,d))}});function Nb(a,b,c,d,e){var f,g,h=0===e,i=h?a.Ts:a.nNb,j=-1;for(g=0;g<i.length;g++)if(f=i[g],f&&f.key===d){j=g;break}j>-1&&i.splice(j,s(c)?1:c),h&&a.phc()}function Ob(a){var b,c;if(a)for(b=a.length-1;b>=0;b--)c=a[b],c.bindingManager.sUa(c)}d.lUa.$n(ab,{priority:7e3,init:function(){this.noa=new Cb(this.kj)},clearPendingChanges:function(a){var b=this.tables;b&&b.Xec(a.tableList)},undoAddRows:function(a){var b=this,c=b.kj,d=a.row,e=a.rowCount,f=c.tables.s$(d,-1,e,-1);f.forEach(function(a){a.WNb(d,e,V(!0))})},getValue:function(a){var b,c,d=a.row,e=a.col,f=a.sheetArea,g=this.kj.tables;3===f&&g&&(b=g.find(d,e),b&&(c=g.ge(d,e),a.isValueGet=c.gt,a.value=c.Qb))},setValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.value,h=a.sheetArea,i=this.kj.tables;3===h&&i&&(b=i.find(e,f),b&&(c=a.changes,d=void 0,c&&(d=c.uVa,d||(c.uVa=[])),a.isValueSet=i.yq(e,f,g)))},undo:function(a){var b=a.uVa,c=a.aOb,d=a.bOb;b&&this.wVa(b),c&&this.cOb(c),d&&this.dOb(d),this.noa.Nm()}}),d.Workbook.$n(ab,{init:function(){d.Commands.mMb(this.commandManager())},onCultureChanged:function(){vb()}})},"./dist/plugins/table/table.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/table/table.res.en.js");b.SR={en:d}},"./dist/plugins/table/table.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",b.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",b.Exp_TableEmptyNameError="The table name cannot be empty.",b.Exp_TableNameInvalid="The table name is not valid.",b.Exp_TableInvalidRow="Invalid row index or row count.",b.Exp_TableInvalidColumn="Invalid column index or column count.",b.Exp_TableIntersectError="The tables cannot be intersected.",b.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",b.Exp_TableDataSourceNullError="Table datasource cannot be null.",b.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",b.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",b.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",b.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",b.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",b.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",b.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",b.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",b.Exp_RowParamOutOfRange="The param row out of data range of table.",b.Exp_ColParamOutOfRange="The param col out of data range of table.",b.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",b.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",b.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",b.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",b.Table_Total="Total",b.Table_None="None",b.Table_Average="Average",b.Table_Count="Count",b.Table_Count_Numbers="Count Numbers",b.Table_Max="Max",b.Table_Min="Min",b.Table_Sum="Sum",b.Table_StdDev="StdDev",b.Table_Var="Var"},Bindings:function(a,b){a.exports=GC.Spread.Sheets.Bindings},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},Filters:function(a,b){a.exports=GC.Spread.Sheets.Filter},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});